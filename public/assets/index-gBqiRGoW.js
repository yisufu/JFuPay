import{x as k,a5 as E}from"./index-B0iOz79E.js";import v from"./popupForm-ClYK_j_g.js";import x from"./configForm-DJVbrzMh.js";import{b as B,T as C,a as I}from"./index-CJwZD0Ka.js";import{e as N,p,at as S,ah as T,a8 as u,z as q,m as F,o as b,h as R,v as r,N as V,_ as z,l as i}from"./vue-DkQzphiS.js";import"./index-tQazVPhs.js";import"./validate-DcgMk89l.js";import"./pay-CU2cU_nZ.js";import"./index-DJv0ClnV.js";const A={class:"default-main ba-table-box"},Q=N({name:"channel",__name:"index",setup(M){const{t:a}=k.useI18n(),m=p(),c=p(!1),o=p(null),g=[{render:"tipButton",name:"edit",title:a("Edit"),type:"primary",icon:"fa fa-pencil",class:"table-row-edit",click:e=>{t.toggleForm("Edit",[e.id])}},{render:"tipButton",name:"config",title:"配置支付参数",type:"success",icon:"fa fa-cog",class:"table-row-config",click:e=>{o.value=e,c.value=!0}},{render:"tipButton",name:"copy",title:"复制通道",type:"info",icon:"fa fa-copy",class:"table-row-copy",click:e=>{_(e)}}],t=new B(new E("/admin/Channel/"),{pk:"id",column:[{type:"selection",align:"center",operator:!1},{label:a("channel.id"),prop:"id",align:"center",width:70,operator:"RANGE",sortable:"custom"},{label:a("channel.name"),prop:"name",align:"center",operatorPlaceholder:a("Fuzzy query"),operator:"LIKE",sortable:!1},{label:a("channel.plugin__plugin_name"),prop:"plugin.plugin_name",align:"center",operatorPlaceholder:a("Fuzzy query"),render:"tags",operator:"LIKE"},{label:a("channel.min_amount"),prop:"min_amount",align:"center",operator:"RANGE",sortable:!1},{label:a("channel.max_amount"),prop:"max_amount",align:"center",operator:"RANGE",sortable:!1},{label:a("channel.priority"),prop:"priority",align:"center",operator:"RANGE",sortable:!1},{label:a("channel.status"),prop:"status",align:"center",render:"tag",operator:"eq",sortable:!1,replaceValue:{0:a("channel.status 0"),1:a("channel.status 1")},custom:{0:"danger",1:"success"}},{label:a("channel.remark"),prop:"remark",align:"center",operatorPlaceholder:a("Fuzzy query"),operator:"LIKE",sortable:!1},{label:a("channel.create_time"),prop:"create_time",align:"center",render:"datetime",operator:"RANGE",sortable:"custom",width:160,timeFormat:"yyyy-mm-dd hh:MM:ss"},{label:a("Operate"),align:"center",width:200,render:"buttons",buttons:g,operator:!1}],dblClickNotEditColumn:[void 0]},{defaultItems:{status:"1"}});S("baTable",t);const h=e=>{t.form.operate="Edit",t.form.operateIds=[e.id],t.form.items={...o.value,config:e.config},t.onSubmit()},_=e=>{T.prompt("请输入新的通道名称","复制通道",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S+/,inputErrorMessage:"通道名称不能为空",inputValue:e.name+"_复制"}).then(({value:l})=>{const s={name:l,plugin_id:e.plugin_id,config:e.config,min_amount:e.min_amount,max_amount:e.max_amount,priority:e.priority,status:e.status,remark:e.remark};t.api.postData("add",s).then(n=>{n.code===1?(u.success("复制成功"),t.getIndex()):u.error(n.msg||"复制失败")}).catch(n=>{console.error("复制通道失败:",n),u.error("复制失败")})}).catch(()=>{})};return q(()=>{var e;t.table.ref=m.value,t.mount(),(e=t.getIndex())==null||e.then(()=>{t.initSort(),t.dragSort()})}),(e,l)=>{var n,d,f;const s=F("el-alert");return b(),R("div",A,[r(t).table.remark?(b(),V(s,{key:0,class:"ba-table-alert",title:r(t).table.remark,type:"info","show-icon":""},null,8,["title"])):z("",!0),i(C,{buttons:["refresh","add","edit","delete","comSearch","quickSearch","columnDisplay"],"quick-search-placeholder":r(a)("Quick search placeholder",{fields:r(a)("channel.quick Search Fields")})},null,8,["quick-search-placeholder"]),i(I,{ref_key:"tableRef",ref:m},null,512),i(v),i(x,{modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=y=>c.value=y),"channel-id":(n=o.value)==null?void 0:n.id,"plugin-id":(d=o.value)==null?void 0:d.plugin_id,config:(f=o.value)==null?void 0:f.config,onSuccess:h},null,8,["modelValue","channel-id","plugin-id","config"])])}}});export{Q as default};
