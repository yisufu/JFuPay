import{e as j,M as S,p as a,z as Y,C as W,f as Q,B as L,o as u,h as r,k as t,V as c,Y as R,Z as B,a6 as O,_ as w,U as P,$ as H,a7 as K,a8 as N}from"./vue-DkQzphiS.js";import{g as q,c as _}from"./pay-CU2cU_nZ.js";import{_ as $}from"./index-B0iOz79E.js";const ee="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC+aJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDE0IDc5LjE1MTQ4MSwgMjAxMy8wMy8xMy0xMjowOToxNSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNDA0NzhEQjg3NUUxMUVDQkNCMkMxMEI5OEMzRTlGNiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNDA0NzhEQzg3NUUxMUVDQkNCMkMxMEI5OEMzRTlGNiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU0MDQ3OEQ5ODc1RTExRUNCQ0IyQzEwQjk4QzNFOUY2IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU0MDQ3OERBODc1RTExRUNCQ0IyQzEwQjk4QzNFOUY2Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+7bgonQAABL1JREFUeNrkWl1sVEUUvmf27t2fLm0Bw6+FBjCmmIqpTQy2+JPywgPwgCWGEDAa4ouJISEVwgPwJPoioLwoBNEXUUKiD4IkxGJpiAKKQkBUsIZSpHRTu23v/t47ntlZ+5PupTtzl/tTT9rb28zPnm/O+c45MzugbO9TyiNUUYA9FPa3WHu+A1EKfcokxPYMoIzVGiy0Z00w2nd0LNj8eLU8Cy8/1nkLlNUBirmZ0y5UXoGHDwA8pX+pAEDxqpDS/JK6o10JlCCTrz24t/wweZydFAB120eoNABP+T0IAnDR763sYMEHYu18XssQxflAFD8J9TsAZWoDQJZQn/gRLVpOSxF36azAE7MD+JQY29GV6+jKZg1bEdXWfuBoa2xTQ8jODPeHzYPnU3vOJF3Y0LyzKsq1/+zn9K/3DYkZnqkJrno8uHtlFN+lMUgCWFOntT0XwZe3Turvfie9fsnWeu3zDdMQAy7BsV8y0iQW9v6tzWF8Xu81Dl9M2XGhL65kdp7W8WXbiogmzCOQDKNvLA+/sCjIvOhsMq7bjVz7O1NX7xmNj6rb8iYVEXMEgIASNVWk7Xn2ScevZo7+mLYfFYczdH9nkhuhTiyagQwHUHvEkMrRve3sU2unk10tUXxKqH4nYW48NoQvhy6kX14WalkcXF+vCbKZCgN4Me88qP2lOzl82dwQeuVp+Uj6e5/BNT7QmUIArfUhQQCgTjhsmkQWzWCLfaG7EDfP/pnbcmJofqWMBboHzMMXC06YSNORyYWyssqYIBKE+nRaUwXL5ga+vsH+bb+Vbb9Vhvpg+QKVTy4RRsXGXO5hnrO6TitvgcMn5JML0ZiIlkAf/pDmC7arpUjUe2quenBtRdPCItRqmKd+u6USnxObcCpuAT65kASU5jahAb/1GdNC8OzCIE8F3Qnan2Q2RBq81hg60hpbURt8tTEc1eDekNk7xJrq5wS2NkUOratYMjOAjK/QoHe40ITh682mMK8m3juXev+8cFoEueP1Iy/FRoIPFmR3B+mTcwohHFnBsaF09Ztcy6JNhkkXzyyM6kmY89/ul9BE2AJcvryW+esfU8/QqjCZV0lmxwjCQP12nNK3n9IxNGGf6ghB1asjMLbpyt9GTIPpEUCLzYiS2wMmJsSvrmXWfDIoe1wh+wUH1mG8mEHHQB5hRJ/YBxeYWDQ99kgAyXd30Fy7VEvnKM7jaDWKnoBVJMtrHyVwda263YwbD0hhfJ5P18fYQu6I/y/3xJQSf+yDrSngcwsQlsh87UJl/9bTjXMh8DsAxbdGGN0TC1O5q78Q4OX2YmOKP1ZK/BE3nLYAVjLf32b1wsolQTsANucLqpM3spIUtlNKNNeqHa9XcTAfX5I5XOFFKErjBwN8g+poLcTr+BEl5ETP0p3f6Ps6UzZ4YO+2Cu7EF1QT/JHZ0cfN673GTz05Owqo4z1KOKieuZl1OvbQ/O9/G0l1fFDyS/CEqVKNTlUA4HcAVOLikQN7FxEXAvDcVQOL8yvy4HDlocJflsTg/trbi0Ku8qGEOyclHKu4dvEDSjG/l/NASZb32r1RJzKxt1KExL1ReKhu73wtBPbuToPjFiiiBB0Hh1rf9xztS8f0tiX/CjAAJ0arwXc4nhEAAAAASUVORK5CYII=",te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAiJJREFUWEftlj2LFEEQht/qYBMTkUPwIxA8VteqHswMLjEUxFOR28DDxF9gdKlneOBfMBMEFU/NDIQLRATBYGZWMfAjODAQDO4HdEmNO8fe3u30jOzsJdvZTE+/7zNd1VVNOORBh+yPOUCtHWDmRSI6Pa1wOed+pWn61fSiACLyFMDKtMxHdLYBXK4EEJHfABZaMC8lNycCiMg7AEstmpv0zoEAIvIIwN2WzQv5fQDMvEZEG7Mw3weQJMlyCOHVrMz3ACRJci6E8B7AsQYAFqrjAK6NrXlDRF9U9V5MazcE3vsPqnoptmBkfj3P8wf2PHZUn+V53h++vw9gvUqzABCRxwBWG5j/SyCiG1mWFSEbQqA0996vqKrVkMpBIhKlrFD4A+BWnudbo9/UNS9+gpl/ENGZGGnF/DfnXD9N00/2TRPzAkBEXh+QRLV5iGgQQugPBoPPtihJkiOq+lxVr9QRIe/9qqpaDjQeo+bMfMEEDKTX651wzm0SUTSpyyRsnAeq+hPAVTM0c+dckXDlbnjvzwN4q6ono6fgf04CET3Jsux2aa6qPDwZuyERkRcAbtYCGCZQo1pgIVDVUwCOjpnsAPgO4GIsrnt6QbfbXeh0OnZRaFINYx7VdWB8lpmXiMha8UzGpHZsrdjqfOtj4oXEe7+hqmstE2xXXsmY+SURXW8R4mGdS6nViDsAzk4LxGoIEX20xhUFmJbpJJ05wHwH/gKf/LkVOCLafgAAAABJRU5ErkJggg==",le={class:"wrap"},se={key:0,class:"error-notice"},ae={class:"error-content"},ne={class:"error-title"},oe={class:"error-desc"},ie={class:"box-pay"},ue={class:"title"},re={class:"shopname"},de={class:"input"},ce={class:"money"},ve={key:0,class:"amount-error"},me={key:1,class:"amount-limit"},Ae={key:3,class:"remark"},pe={class:"table_font"},ke={class:"brand"},ye={cellspacing:"5",cellpadding:"0",border:"0"},be={class:"dialog-remark"},we={class:"dialog-body"},Ee={class:"remark-input"},fe=j({__name:"payment",setup(ge){const T=S(),M=a(""),z=a(0),d=a(0),i=a(0),U=a(""),C=a(""),s=a(""),v=a(!1),E=a(0);a(0),a([{id:1,name:"微信支付商户直连",desc:"微信官方商户号直连支付",icon:"/assets/images/pay/wxpay.png"},{id:2,name:"支付宝商户直连",desc:"支付宝官方商户号直连支付",icon:"/assets/images/pay/alipay.png"},{id:3,name:"易速付",desc:"第三方聚合支付通道",icon:"/assets/images/pay/yisufu.png"},{id:4,name:"汇付天下",desc:"第三方聚合支付通道",icon:"/assets/images/pay/huifu.png"}]);const A=a(""),p=a(""),f=a(!1),m=a(""),k=a(!1),y=a(""),b=a(""),D=a(!1),G=async()=>{try{const l=T.query.uuid;if(!l||typeof l!="string"){k.value=!0,y.value="参数错误",b.value="收款码不存在或已失效";return}const e=await q(l);e.code===1?(M.value=e.data.name,z.value=e.data.min_amount,d.value=e.data.max_amount,i.value=e.data.fixed_amount,U.value=e.data.uuid,C.value=e.data.website_name||"",i.value>0&&(s.value=i.value.toString())):(k.value=!0,y.value="获取收款码失败",b.value=e.msg||"收款码不存在或已失效")}catch(l){console.error("获取商户信息失败:",l),k.value=!0,y.value="系统错误",b.value="获取收款码信息失败,请稍后重试"}};Y(()=>{G()}),W(()=>{});const J=Q(()=>{const l=parseFloat(s.value||"0");return i.value>0?l===i.value:s.value&&l>0});L(()=>parseFloat(s.value||"0"),l=>{m.value=""});const o=l=>{if(!(i.value>0)){if(m.value="",l==="."){s.value?v.value||(s.value+=".",v.value=!0):(s.value="0.",v.value=!0);return}if(v.value){if(E.value<2){const e=s.value+l,n=parseFloat(e);if(d.value>0&&n>d.value){m.value=`金额不能超过${d.value}元`;return}s.value=e,E.value++}}else{const e=s.value===""?l:s.value+l,n=parseFloat(e);if(d.value>0&&n>d.value){m.value=`金额不能超过${d.value}元`;return}s.value=e}}},X=()=>{if(i.value>0||!s.value)return;const l=s.value.slice(-1);s.value=s.value.slice(0,-1),l==="."?v.value=!1:v.value&&E.value--,s.value==="0"&&(s.value="")},Z=async()=>{if(!s.value){N.error("请输入支付金额");return}try{D.value=!0;const l=await _({uuid:U.value,amount:s.value,remark:A.value});if(l.code===1){const e=l.data.pay_url;window.location.href=e}else N.error(l.msg||"支付失败")}catch(l){console.error("支付请求失败:",l),N.error(l.message||"支付请求失败")}finally{D.value=!1}},I=()=>{p.value=A.value,f.value=!0},g=()=>{f.value=!1},F=()=>{A.value=p.value,g()},x=Q(()=>i.value>0),V=()=>{const l=document.documentElement.scrollTop||document.body.scrollTop,e=document.querySelector('meta[name="viewport"]');e&&e.setAttribute("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"),document.body.style.position="fixed",document.body.style.width="100%",document.body.style.top=`-${l}px`},h=()=>{const l=document.querySelector('meta[name="viewport"]');l&&l.setAttribute("content","width=device-width, initial-scale=1.0");const e=Math.abs(parseFloat(document.body.style.top));document.body.style.position="",document.body.style.width="",document.body.style.top="",window.scrollTo(0,e)};return(l,e)=>(u(),r("div",le,[k.value?(u(),r("div",se,[t("div",ae,[e[14]||(e[14]=t("i",{class:"el-icon-warning"},null,-1)),t("p",ne,c(y.value),1),t("p",oe,c(b.value),1)])])):(u(),r(R,{key:1},[t("div",ie,[t("div",ue,[e[15]||(e[15]=t("div",{class:"merchant-avatar"},[t("img",{src:ee,alt:"商户"})],-1)),e[16]||(e[16]=t("div",{class:"label"},"付款给",-1)),t("div",re,c(M.value),1)]),t("div",de,[e[21]||(e[21]=t("div",{class:"label"},"付款金额",-1)),t("div",ce,[e[17]||(e[17]=t("span",{class:"money_icon"},"¥",-1)),B(t("input",{id:"money_num",type:"text","onUpdate:modelValue":e[0]||(e[0]=n=>s.value=n),readonly:"",placeholder:"0.00"},null,512),[[O,s.value]])]),m.value?(u(),r("div",ve,[e[18]||(e[18]=t("i",{class:"el-icon-warning-outline"},null,-1)),t("span",null,c(m.value),1)])):w("",!0),x.value?(u(),r("div",me,[i.value>0?(u(),r(R,{key:0},[P(" 固定支付金额: ¥"+c(i.value),1)],64)):w("",!0)])):w("",!0),A.value?(u(),r("div",Ae,[e[20]||(e[20]=t("span",null,"备注：",-1)),t("span",null,c(A.value),1),t("span",{class:"btn-edit-remark",onClick:I},"修改")])):(u(),r("div",{key:2,class:"remark",onClick:I},e[19]||(e[19]=[t("span",null,"添加备注",-1)])))])]),t("div",pe,[t("div",ke,c(C.value)+" 提供技术支持",1),t("table",ye,[t("tr",null,[t("td",{class:"click_num",onClick:e[1]||(e[1]=n=>o("1"))},"1"),t("td",{class:"click_num",onClick:e[2]||(e[2]=n=>o("2"))},"2"),t("td",{class:"click_num",onClick:e[3]||(e[3]=n=>o("3"))},"3"),t("td",{class:"deleateNum",onClick:X},e[22]||(e[22]=[t("img",{src:te,alt:"删除",class:"delete-icon"},null,-1)]))]),t("tr",null,[t("td",{class:"click_num",onClick:e[4]||(e[4]=n=>o("4"))},"4"),t("td",{class:"click_num",onClick:e[5]||(e[5]=n=>o("5"))},"5"),t("td",{class:"click_num",onClick:e[6]||(e[6]=n=>o("6"))},"6"),t("td",{rowspan:"3",class:H(["sure_button",{disabled:!J.value}]),onClick:Z},"付款",2)]),t("tr",null,[t("td",{class:"click_num",onClick:e[7]||(e[7]=n=>o("7"))},"7"),t("td",{class:"click_num",onClick:e[8]||(e[8]=n=>o("8"))},"8"),t("td",{class:"click_num",onClick:e[9]||(e[9]=n=>o("9"))},"9")]),t("tr",null,[t("td",{colspan:"2",class:"click_num",onClick:e[10]||(e[10]=n=>o("0"))},"0"),t("td",{class:"click_num",onClick:e[11]||(e[11]=n=>o("."))},".")])])]),f.value?(u(),r("div",{key:0,class:"dialog-mask",onTouchmove:e[13]||(e[13]=K(()=>{},["prevent"]))},[t("div",be,[t("div",{class:"dialog-header"},[e[23]||(e[23]=t("span",null,"添加备注",-1)),t("i",{class:"close-icon el-icon-close",onClick:g})]),t("div",we,[t("div",Ee,[B(t("textarea",{"onUpdate:modelValue":e[12]||(e[12]=n=>p.value=n),placeholder:"添加备注",onFocus:V,onBlur:h,enterkeyhint:"done"},null,544),[[O,p.value]])])]),t("div",{class:"dialog-footer"},[t("button",{class:"cancel-btn",onClick:g},"取消"),t("button",{class:"confirm-btn",onClick:F},"确定")])])],32)):w("",!0)],64))]))}}),Ce=$(fe,[["__scopeId","data-v-36568b7b"]]);export{Ce as default};
