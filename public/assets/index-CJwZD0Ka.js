var Po=Object.defineProperty;var $o=(n,e,t)=>e in n?Po(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var J=(n,e,t)=>$o(n,typeof e!="symbol"?e+"":e,t);import{i as Mo,Z as Zt,$ as Fo,a0 as xo,a1 as Lo,_ as re,x as Et,j as pt,X as Yo,f as He,a2 as ht,e as co,B as fo,a3 as Uo,a4 as Ge,a5 as zo,w as Ot,a6 as Bo,a7 as jo,a8 as Ho,a9 as Go}from"./index-B0iOz79E.js";import{e as Z,p as Pe,a as ke,f as se,B as lt,z as Dt,m as D,o as p,N as A,O as T,l as k,k as B,h as V,V as j,_ as M,$ as Ie,Y as X,X as ce,a7 as nt,n as Le,W as Ye,U as _e,Z as ne,v as h,al as at,am as qo,an as ge,j as Ko,ai as It,L as Vt,i as we,ao as be,ap as Ct,aa as po,aq as ho,ad as Xo,ae as Wo,ar as mo,H as Qo,M as Zo,as as Rt,at as Jo,au as go,av as bo,aw as vo,ax as en,a9 as tn,af as Jt,A as on,Q as nn}from"./vue-DkQzphiS.js";import{p as ln}from"./index-DJv0ClnV.js";const an={class:"icon-selector-box"},rn={class:"selector-header"},sn={class:"selector-title"},un={class:"selector-tab"},cn=["title"],dn=["title"],fn=["title"],pn=["title"],hn={class:"selector-body"},mn={key:0},gn=["title","onClick"],bn={class:"icon-prepend"},vn={key:0,class:"name"},yn=Z({__name:"iconSelector",props:{size:{default:"default"},disabled:{type:Boolean,default:!1},title:{default:""},type:{default:"ele"},placement:{default:"bottom"},modelValue:{default:""},showIconName:{type:Boolean,default:!1}},emits:["update:modelValue","change"],setup(n,{emit:e}){const t=n,o=e,l=Pe(),a=Pe(),r=ke({iconType:t.type,selectorWidth:0,popoverVisible:!1,inputFocus:!1,iconSelectorMouseover:!1,fontIconNames:[],inputValue:"",prependIcon:t.modelValue,defaultModelValue:t.modelValue||"fa fa-circle-o",iconKey:0}),i=()=>{r.inputFocus=r.popoverVisible=!0},c=()=>{r.inputFocus=!1,r.popoverVisible=r.iconSelectorMouseover},u=()=>{r.iconKey++,r.prependIcon=r.defaultModelValue,r.inputValue="",o("update:modelValue",r.defaultModelValue),o("change",r.defaultModelValue)},m=s=>{r.iconType=s,r.fontIconNames=[],s=="ele"?Zt().then(E=>{r.fontIconNames=E}):s=="awe"?Fo().then(E=>{r.fontIconNames=E.map(F=>`fa ${F}`)}):s=="ali"?xo().then(E=>{r.fontIconNames=E.map(F=>`iconfont ${F}`)}):s=="local"&&Lo().then(E=>{r.fontIconNames=E})},g=s=>{r.iconSelectorMouseover=r.popoverVisible=!1,r.iconKey++,r.prependIcon=s,r.inputValue="",o("update:modelValue",s),o("change",s),Le(()=>{l.value.blur()})},_=se(()=>{if(!r.inputValue)return r.fontIconNames;let s=r.inputValue.trim().toLowerCase();return r.fontIconNames.filter(E=>{if(E.toLowerCase().indexOf(s)!==-1)return E})}),y=()=>{Le(()=>{r.selectorWidth=l.value.$el.offsetWidth<260?260:l.value.$el.offsetWidth})},d=()=>{r.popoverVisible=!!(r.inputFocus||r.iconSelectorMouseover)};return lt(()=>t.modelValue,()=>{r.iconKey++,t.modelValue!=r.prependIcon&&(r.defaultModelValue=t.modelValue),t.modelValue==""&&(r.defaultModelValue="fa fa-circle-o"),r.prependIcon=t.modelValue}),Dt(()=>{y(),Mo(document,"click",d),Zt().then(s=>{r.fontIconNames=s})}),(s,E)=>{const F=D("Icon"),R=D("el-scrollbar"),x=D("el-input"),L=D("el-popover");return p(),A(L,{placement:s.placement,trigger:"focus","hide-after":0,width:r.selectorWidth,visible:r.popoverVisible},{reference:T(()=>[k(x,{modelValue:r.inputValue,"onUpdate:modelValue":E[6]||(E[6]=I=>r.inputValue=I),size:s.size,disabled:s.disabled,placeholder:s.$t("Search")+s.$t("utils.Icon"),ref_key:"selectorInput",ref:l,onFocus:i,onBlur:c,class:Ie("size-"+s.size)},{prepend:T(()=>[B("div",bn,[(p(),A(F,{key:"icon"+r.iconKey,name:r.prependIcon?r.prependIcon:r.defaultModelValue},null,8,["name"])),s.showIconName?(p(),V("div",vn,j(r.prependIcon?r.prependIcon:r.defaultModelValue),1)):M("",!0)])]),append:T(()=>[k(F,{onClick:u,name:"el-icon-RefreshRight"})]),_:1},8,["modelValue","size","disabled","placeholder","class"])]),default:T(()=>[B("div",{onMouseover:E[4]||(E[4]=nt(I=>r.iconSelectorMouseover=!0,["stop"])),onMouseout:E[5]||(E[5]=nt(I=>r.iconSelectorMouseover=!1,["stop"])),class:"icon-selector"},[B("div",an,[B("div",rn,[B("div",sn,j(s.title?s.title:s.$t("utils.Please select an icon")),1),B("div",un,[B("span",{title:"Element Puls "+s.$t("utils.Icon"),onClick:E[0]||(E[0]=I=>m("ele")),class:Ie(r.iconType=="ele"?"active":"")}," ele ",10,cn),B("span",{title:"Font Awesome "+s.$t("utils.Icon"),onClick:E[1]||(E[1]=I=>m("awe")),class:Ie(r.iconType=="awe"?"active":"")}," awe ",10,dn),B("span",{title:s.$t("utils.Ali iconcont Icon"),onClick:E[2]||(E[2]=I=>m("ali")),class:Ie(r.iconType=="ali"?"active":"")}," ali ",10,fn),B("span",{title:s.$t("utils.Local icon title"),onClick:E[3]||(E[3]=I=>m("local")),class:Ie(r.iconType=="local"?"active":"")}," local ",10,pn)])]),B("div",hn,[k(R,{ref_key:"selectorScrollbarRef",ref:a},{default:T(()=>[_.value.length>0?(p(),V("div",mn,[(p(!0),V(X,null,ce(_.value,(I,w)=>(p(),V("div",{class:"icon-selector-item",title:I,onClick:f=>g(I),key:w},[k(F,{name:I},null,8,["name"])],8,gn))),128))])):M("",!0)]),_:1},512)])])],32)]),_:1},8,["placement","width","visible"])}}}),_n=re(yn,[["__scopeId","data-v-13330066"]]),wn=["string","password","number","radio","checkbox","switch","textarea","array","datetime","year","date","time","select","selects","remoteSelect","remoteSelects","editor","city","image","images","file","files","icon","color"],Sn=Z({__name:"array",props:{modelValue:{default:()=>[]},keyTitle:{default:""},valueTitle:{default:""}},setup(n){const{t:e}=Et.useI18n(),t=n,o=ke({value:t.modelValue,keyTitle:t.keyTitle?t.keyTitle:e("utils.ArrayKey"),valueTitle:t.valueTitle?t.valueTitle:e("utils.ArrayValue")}),l=()=>{o.value.push({key:"",value:""})},a=r=>{o.value.splice(r,1)};return lt(()=>t.modelValue,r=>{o.value=r}),(r,i)=>{const c=D("el-col"),u=D("el-row"),m=D("el-input"),g=D("el-button"),_=Ye("blur");return p(),V("div",null,[k(u,{gutter:10},{default:T(()=>[k(c,{span:10,class:"ba-array-key"},{default:T(()=>[_e(j(o.keyTitle),1)]),_:1}),k(c,{span:10,class:"ba-array-value"},{default:T(()=>[_e(j(o.valueTitle),1)]),_:1})]),_:1}),(p(!0),V(X,null,ce(o.value,(y,d)=>(p(),A(u,{class:"ba-array-item",gutter:10,key:d},{default:T(()=>[k(c,{span:10},{default:T(()=>[k(m,{modelValue:y.key,"onUpdate:modelValue":s=>y.key=s},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),k(c,{span:10},{default:T(()=>[k(m,{modelValue:y.value,"onUpdate:modelValue":s=>y.value=s},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),k(c,{span:4},{default:T(()=>[k(g,{onClick:s=>a(d),size:"small",icon:"el-icon-Delete",circle:""},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),k(u,{gutter:10},{default:T(()=>[k(c,{span:10,offset:10},{default:T(()=>[ne((p(),A(g,{class:"ba-add-array-item",onClick:l,icon:"el-icon-Plus"},{default:T(()=>[_e(j(h(e)("Add")),1)]),_:1})),[[_]])]),_:1})]),_:1})])}}}),Tn=re(Sn,[["__scopeId","data-v-b7b95894"]]),q=()=>({null:!1,primaryKey:!1,unsigned:!1,autoIncrement:!1}),Ra={string:{type:"varchar",length:255,precision:0,defaultType:"EMPTY STRING",...q()},password:{type:"varchar",length:32,precision:0,defaultType:"EMPTY STRING",...q()},number:{type:"int",length:10,precision:0,defaultType:"NULL",...q(),null:!0},radio:{type:"enum",length:0,precision:0,defaultType:"NULL",...q(),null:!0},checkbox:{type:"set",length:0,precision:0,defaultType:"NULL",...q(),null:!0},switch:{type:"tinyint",length:1,precision:0,default:"0",defaultType:"INPUT",...q(),unsigned:!0},textarea:{type:"varchar",length:255,precision:0,defaultType:"EMPTY STRING",...q()},array:{type:"varchar",length:255,precision:0,defaultType:"EMPTY STRING",...q()},datetime:{type:"bigint",length:16,precision:0,defaultType:"NULL",...q(),null:!0,unsigned:!0},year:{type:"year",length:4,precision:0,defaultType:"NULL",...q(),null:!0},date:{type:"date",length:0,precision:0,defaultType:"NULL",...q(),null:!0},time:{type:"time",length:0,precision:0,defaultType:"NULL",...q(),null:!0},select:{type:"enum",length:0,precision:0,defaultType:"NULL",...q(),null:!0},selects:{type:"varchar",length:255,precision:0,defaultType:"EMPTY STRING",...q()},remoteSelect:{type:"int",length:10,precision:0,defaultType:"NULL",...q(),null:!0,unsigned:!0},remoteSelects:{type:"varchar",length:255,precision:0,defaultType:"EMPTY STRING",...q()},editor:{type:"text",length:0,precision:0,defaultType:"NULL",...q(),null:!0},city:{type:"varchar",length:100,precision:0,defaultType:"EMPTY STRING",...q()},image:{type:"varchar",length:255,precision:0,defaultType:"EMPTY STRING",...q()},images:{type:"varchar",length:1500,precision:0,defaultType:"EMPTY STRING",...q()},file:{type:"varchar",length:255,precision:0,defaultType:"EMPTY STRING",...q()},files:{type:"varchar",length:1500,precision:0,defaultType:"EMPTY STRING",...q()},icon:{type:"varchar",length:50,precision:0,defaultType:"EMPTY STRING",...q()},color:{type:"varchar",length:50,precision:0,defaultType:"EMPTY STRING",...q()}},eo=n=>typeof n=="string"?n==""?[]:n.split(","):n,kn={key:1,class:"text"},En={key:1,class:"text"},Dn={class:"ml-6"},In={key:1,class:"text"},Vn={key:1,class:"text"},Cn=Z({__name:"buttons",props:{row:{},field:{},column:{},index:{}},setup(n){const{t:e,te:t}=Et.useI18n(),o=n,l=at("baTable"),a=i=>{if(typeof i.click=="function"){i.click(o.row,o.field);return}l.onTableAction(i.name,o)},r=i=>i?t(i)?e(i):i:"";return(i,c)=>{const u=D("Icon"),m=D("el-button"),g=D("el-tooltip"),_=D("el-popconfirm"),y=Ye("blur");return qo([i.field],()=>(p(),V("div",null,[(p(!0),V(X,null,ce(i.field.buttons,(d,s)=>(p(),V(X,{key:s},[!d.display||d.display(i.row,i.field)?(p(),V(X,{key:0},[d.render=="basicButton"?ne((p(),A(m,ge({key:0,onClick:E=>a(d),class:[d.class,"ba-table-render-buttons-item"],type:d.type,disabled:d.disabled&&d.disabled(i.row,i.field),ref_for:!0},d.attr),{default:T(()=>[d.icon?(p(),A(u,{key:0,name:d.icon},null,8,["name"])):M("",!0),d.text?(p(),V("div",kn,j(r(d.text)),1)):M("",!0)]),_:2},1040,["onClick","class","type","disabled"])),[[y]]):M("",!0),d.render=="tipButton"&&(d.name=="edit"&&h(l).auth("edit")||d.name!="edit")?(p(),A(g,{key:1,disabled:!(d.title&&!d.disabledTip),content:r(d.title),placement:"top"},{default:T(()=>[ne((p(),A(m,ge({onClick:E=>a(d),class:[d.class,"ba-table-render-buttons-item"],type:d.type,disabled:d.disabled&&d.disabled(i.row,i.field),ref_for:!0},d.attr),{default:T(()=>[d.icon?(p(),A(u,{key:0,name:d.icon},null,8,["name"])):M("",!0),d.text?(p(),V("div",En,j(r(d.text)),1)):M("",!0)]),_:2},1040,["onClick","class","type","disabled"])),[[y]])]),_:2},1032,["disabled","content"])):M("",!0),d.render=="confirmButton"&&(d.name=="delete"&&h(l).auth("del")||d.name!="delete")?(p(),A(_,ge({key:2,disabled:d.disabled&&d.disabled(i.row,i.field),ref_for:!0},d.popconfirm,{onConfirm:E=>a(d)}),{reference:T(()=>[B("div",Dn,[k(g,{disabled:!d.title,content:r(d.title),placement:"top"},{default:T(()=>[ne((p(),A(m,ge({class:[d.class,"ba-table-render-buttons-item"],type:d.type,disabled:d.disabled&&d.disabled(i.row,i.field),ref_for:!0},d.attr),{default:T(()=>[d.icon?(p(),A(u,{key:0,name:d.icon},null,8,["name"])):M("",!0),d.text?(p(),V("div",In,j(r(d.text)),1)):M("",!0)]),_:2},1040,["class","type","disabled"])),[[y]])]),_:2},1032,["disabled","content"])])]),_:2},1040,["disabled","onConfirm"])):M("",!0),d.render=="moveButton"&&(d.name=="weigh-sort"&&h(l).auth("sortable")||d.name!="weigh-sort")?(p(),A(g,{key:3,disabled:!(d.title&&!d.disabledTip),content:r(d.title),placement:"top"},{default:T(()=>[k(m,ge({class:[d.class,"ba-table-render-buttons-item move-button"],type:d.type,disabled:d.disabled&&d.disabled(i.row,i.field),ref_for:!0},d.attr),{default:T(()=>[d.icon?(p(),A(u,{key:0,name:d.icon},null,8,["name"])):M("",!0),d.text?(p(),V("div",Vn,j(r(d.text)),1)):M("",!0)]),_:2},1040,["class","type","disabled"])]),_:2},1032,["disabled","content"])):M("",!0)],64)):M("",!0)],64))),128))])),c,0)}}}),An=re(Cn,[["__scopeId","data-v-bbe2c6a6"]]),On=Object.freeze(Object.defineProperty({__proto__:null,default:An},Symbol.toStringTag,{value:"Module"})),Se=(n,e,t,o)=>{if(!e.prop)return"";const l=e.prop;let a=n[l];if(l.indexOf(".")>-1){const r=l.split(".");a=n[r[0]];for(let i=1;i<r.length;i++)a=a?a[r[i]]??"":""}return[void 0,null,""].includes(a)&&e.default!==void 0&&(a=e.default),e.renderFormatter&&typeof e.renderFormatter=="function"&&(a=e.renderFormatter(n,e,a,t,o),console.warn("baTable.table.column.renderFormatter 即将废弃，请直接使用兼容 el-table 的 baTable.table.column.formatter 代替")),e.formatter&&typeof e.formatter=="function"&&(a=e.formatter(n,t,a,o)),a},Na=(n=["weigh-sort","edit","delete"])=>{const e=new Map([["weigh-sort",{render:"moveButton",name:"weigh-sort",title:"Drag sort",text:"",type:"info",icon:"fa fa-arrows",class:"table-row-weigh-sort",disabledTip:!1}],["edit",{render:"tipButton",name:"edit",title:"Edit",text:"",type:"primary",icon:"fa fa-pencil",class:"table-row-edit",disabledTip:!1}],["delete",{render:"confirmButton",name:"delete",title:"Delete",text:"",type:"danger",icon:"fa fa-trash",class:"table-row-delete",popconfirm:{confirmButtonText:pt.global.t("Delete"),cancelButtonText:pt.global.t("Cancel"),confirmButtonType:"danger",title:pt.global.t("Are you sure to delete the selected record?")},disabledTip:!1}]]),t=[];for(const o in n)e.has(n[o])&&t.push(e.get(n[o]));return t},zt=(n,e,t=-1)=>{for(const o in n){if(typeof t=="number"&&t++,t==e)return n[o];if(n[o].children&&(t=zt(n[o].children,e,t),typeof t!="number"))return t}return t},Rn=Z({__name:"color",props:{row:{},field:{},column:{},index:{}},setup(n){const e=n,t=Se(e.row,e.field,e.column,e.index);return(o,l)=>(p(),V("div",null,[B("div",{style:Ko({background:h(t)}),class:"ba-table-render-color"},null,4)]))}}),Nn=re(Rn,[["__scopeId","data-v-5c132ae2"]]),Pn=Object.freeze(Object.defineProperty({__proto__:null,default:Nn},Symbol.toStringTag,{value:"Module"})),$n=Z({__name:"customRender",props:{row:{},field:{},column:{},index:{}},setup(n){const e=n,t=Se(e.row,e.field,e.column,e.index);return(o,l)=>(p(),V("div",null,[(p(),A(It(o.field.customRender),{renderRow:o.row,renderField:o.field,renderValue:h(t),renderColumn:o.column,renderIndex:o.index},null,8,["renderRow","renderField","renderValue","renderColumn","renderIndex"]))]))}}),Mn=Object.freeze(Object.defineProperty({__proto__:null,default:$n},Symbol.toStringTag,{value:"Module"})),Fn=["innerHTML"],xn=Z({__name:"customTemplate",props:{row:{},field:{},column:{},index:{}},setup(n){const e=n,t=Se(e.row,e.field,e.column,e.index);return(o,l)=>(p(),V("div",null,[B("div",{innerHTML:o.field.customTemplate?o.field.customTemplate(o.row,o.field,h(t),o.column,o.index):""},null,8,Fn)]))}}),Ln=Object.freeze(Object.defineProperty({__proto__:null,default:xn},Symbol.toStringTag,{value:"Module"})),Yn=Z({__name:"datetime",props:{row:{},field:{},column:{},index:{}},setup(n){const e=n,t=Se(e.row,e.field,e.column,e.index);return(o,l)=>(p(),V("div",null,j(h(t)?h(Yo)(h(t),o.field.timeFormat??"yyyy-mm-dd hh:MM:ss"):"-"),1))}}),Un=Object.freeze(Object.defineProperty({__proto__:null,default:Yn},Symbol.toStringTag,{value:"Module"})),zn={};function Bn(n,e){const t=D("el-tag");return p(),V("div",null,[k(t,{effect:"dark",type:"danger"},{default:T(()=>e[0]||(e[0]=[_e("Field renderer not found")])),_:1})])}const jn=re(zn,[["render",Bn]]),Hn=Object.freeze(Object.defineProperty({__proto__:null,default:jn},Symbol.toStringTag,{value:"Module"})),Gn=Z({__name:"icon",props:{row:{},field:{},column:{},index:{}},setup(n){const e=n;return(t,o)=>{const l=D("Icon",!0);return p(),V("div",null,[k(l,{color:"var(--el-text-color-primary)",name:h(Se)(e.row,e.field,e.column,e.index)},null,8,["name"])])}}}),qn=Object.freeze(Object.defineProperty({__proto__:null,default:Gn},Symbol.toStringTag,{value:"Module"})),Kn=Z({__name:"image",props:{row:{},field:{},column:{},index:{}},setup(n){const e=n,t=Se(e.row,e.field,e.column,e.index);return(o,l)=>{const a=D("el-image");return p(),V("div",null,[h(t)?(p(),A(a,{key:0,"hide-on-click-modal":!0,"preview-teleported":!0,"preview-src-list":[h(He)(h(t))],src:h(He)(h(t)),class:"ba-table-render-image"},null,8,["preview-src-list","src"])):M("",!0)])}}}),Xn=re(Kn,[["__scopeId","data-v-f9208128"]]),Wn=Object.freeze(Object.defineProperty({__proto__:null,default:Xn},Symbol.toStringTag,{value:"Module"})),Qn=Z({__name:"images",props:{row:{},field:{},column:{},index:{}},setup(n){const e=n,t=Se(e.row,e.field,e.column,e.index);return(o,l)=>{const a=D("el-image");return p(),V("div",null,[h(Vt)(h(t))&&h(t).length?(p(!0),V(X,{key:0},ce(h(t),(r,i)=>(p(),A(a,{key:i,"initial-index":i,"preview-teleported":!0,"preview-src-list":h(ht)(h(t)),class:"ba-table-render-images-item",src:h(He)(r),"hide-on-click-modal":!0},null,8,["initial-index","preview-src-list","src"]))),128)):M("",!0)])}}}),Zn=re(Qn,[["__scopeId","data-v-9d865e58"]]),Jn=Object.freeze(Object.defineProperty({__proto__:null,default:Zn},Symbol.toStringTag,{value:"Module"})),el=Z({__name:"switch",props:{row:{},field:{},column:{},index:{}},setup(n){const e=Pe(!1),t=n,o=at("baTable"),l=Pe(Se(t.row,t.field,t.column,t.index));typeof l.value=="number"&&(l.value=l.value.toString());const a=r=>{e.value=!0,o.api.postData("edit",{[o.table.pk]:t.row[o.table.pk],[t.field.prop]:r}).then(()=>{l.value=r,o.onTableAction("field-change",{value:r,...t})}).finally(()=>{e.value=!1})};return(r,i)=>{const c=D("el-switch");return p(),V("div",null,[r.field.prop?(p(),A(c,{key:0,onChange:a,"model-value":l.value,loading:e.value,"active-value":"1","inactive-value":"0"},null,8,["model-value","loading"])):M("",!0)])}}}),tl=Object.freeze(Object.defineProperty({__proto__:null,default:el},Symbol.toStringTag,{value:"Module"})),ol=Z({__name:"tag",props:{row:{},field:{},column:{},index:{}},setup(n){const e=n,t=Se(e.row,e.field,e.column,e.index),o=(l,a)=>!we(a)&&a[l]?a[l]:"primary";return(l,a)=>{const r=D("el-tag");return p(),V("div",null,[[null,void 0,""].includes(h(t))?M("",!0):(p(),A(r,{key:0,type:o(h(t),l.field.custom),effect:l.field.effect??"light",size:l.field.size??"default"},{default:T(()=>[_e(j(h(we)(l.field.replaceValue)?h(t):l.field.replaceValue[h(t)]??h(t)),1)]),_:1},8,["type","effect","size"]))])}}}),nl=Object.freeze(Object.defineProperty({__proto__:null,default:ol},Symbol.toStringTag,{value:"Module"})),ll=Z({__name:"tags",props:{row:{},field:{},column:{},index:{}},setup(n){const e=n,t=Se(e.row,e.field,e.column,e.index),o=(l,a)=>!we(a)&&a[l]?a[l]:"primary";return(l,a)=>{const r=D("el-tag");return p(),V("div",null,[h(Vt)(h(t))?(p(!0),V(X,{key:0},ce(h(t),(i,c)=>(p(),V(X,{key:c},[[null,void 0,""].includes(i)?M("",!0):(p(),A(r,{key:0,class:"m-4",type:o(i,l.field.custom),effect:l.field.effect??"light",size:l.field.size??"default"},{default:T(()=>[_e(j(h(we)(l.field.replaceValue)?i:l.field.replaceValue[i]??i),1)]),_:2},1032,["type","effect","size"]))],64))),128)):(p(),V(X,{key:1},[[null,void 0,""].includes(h(t))?M("",!0):(p(),A(r,{key:0,type:o(h(t),l.field.custom),effect:l.field.effect??"light",size:l.field.size??"default"},{default:T(()=>[_e(j(h(we)(l.field.replaceValue)?h(t):l.field.replaceValue[h(t)]??h(t)),1)]),_:1},8,["type","effect","size"]))],64))])}}}),al=re(ll,[["__scopeId","data-v-2eb24b78"]]),rl=Object.freeze(Object.defineProperty({__proto__:null,default:al},Symbol.toStringTag,{value:"Module"})),il=Z({__name:"url",props:{row:{},field:{},column:{},index:{}},setup(n){const e=n;e.field.click&&console.warn("baTable.table.column.click 即将废弃，请使用 el-table 的 @cell-click 或单元格自定义渲染代替");const t=Se(e.row,e.field,e.column,e.index),o=(l,a)=>{a.target=="_blank"?window.open(l):window.location.href=l};return(l,a)=>{const r=D("Icon"),i=D("el-button"),c=D("el-input");return p(),V("div",null,[k(c,{"model-value":h(t),placeholder:l.$t("Link address")},{append:T(()=>[k(i,{onClick:a[0]||(a[0]=u=>o(h(t),l.field))},{default:T(()=>[k(r,{color:"#606266",name:"el-icon-Position"})]),_:1})]),_:1},8,["model-value","placeholder"])])}}}),sl=Object.freeze(Object.defineProperty({__proto__:null,default:il},Symbol.toStringTag,{value:"Module"})),ul={key:0,class:"table-pagination"},cl=Z({__name:"index",props:{pagination:{type:Boolean,default:!0}},setup(n,{expose:e}){const t=co(),o=Pe(),l=at("baTable"),a=n,r={},i=Object.assign({"./fieldRender/buttons.vue":On,"./fieldRender/color.vue":Pn,"./fieldRender/customRender.vue":Mn,"./fieldRender/customTemplate.vue":Ln,"./fieldRender/datetime.vue":Un,"./fieldRender/default.vue":Hn,"./fieldRender/icon.vue":qn,"./fieldRender/image.vue":Wn,"./fieldRender/images.vue":Jn,"./fieldRender/switch.vue":tl,"./fieldRender/tag.vue":nl,"./fieldRender/tags.vue":rl,"./fieldRender/url.vue":sl});for(const w in i){const f=w.replace("./fieldRender/","").replace(".vue","");r[f]=i[w].default}const c=(w,f,b)=>f.getRenderKey&&typeof f.getRenderKey=="function"?f.getRenderKey(b.row,f,b.column,b.$index):f.render=="switch"?f.render+f.prop:w+b.$index+"-"+f.render+"-"+(f.prop?"-"+f.prop+"-"+b.row[f.prop]:""),u=w=>{l.onTableAction("page-size-change",{size:w})},m=w=>{l.onTableAction("current-page-change",{page:w})},g=({order:w,prop:f})=>{l.onTableAction("sort-change",{prop:f,order:w?w=="ascending"?"asc":"desc":""})},_=se(()=>{let w=[10,20,50,100];return l.table.filter.limit&&(w.includes(l.table.filter.limit)||w.push(l.table.filter.limit)),w}),y=w=>{var f;d(w.map(b=>b[l.table.pk].toString()))?w.map(b=>{b.children&&s(b.children,!0)}):(f=o.value)==null||f.clearSelection()},d=w=>{let f=l.table.data;for(const b in f)return w.includes(f[b][l.table.pk].toString());return!1},s=(w,f)=>{w.map(b=>{E(b,f),b.children&&s(b.children,f)})},E=(w,f)=>{w&&Le(()=>{var b;(b=o.value)==null||b.toggleRowSelection(w,f)})},F=(w,f)=>{w.some(b=>f[l.table.pk]===b[l.table.pk])?f.children&&s(f.children,!0):f.children&&s(f.children,!1)},R=w=>{l.onTableAction("selection-change",w)},x=(w,f)=>{var b;for(const C in w)(b=o.value)==null||b.toggleRowExpansion(w[C],f),w[C].children&&x(w[C].children,f)};return e({unFoldAll:w=>{x(l.table.data,w)},getRef:()=>o.value}),(w,f)=>{const b=D("el-table-column"),C=D("el-table"),v=D("el-pagination"),O=Ye("loading");return p(),V("div",null,[be(w.$slots,"neck",{},void 0,!0),ne((p(),A(C,ge({ref_key:"tableRef",ref:o,class:"ba-data-table w100","header-cell-class-name":"table-header-cell","default-expand-all":h(l).table.expandAll,data:h(l).table.data,"row-key":h(l).table.pk,border:!0,stripe:"",onSelectAll:y,onSelect:F,onSelectionChange:R,onSortChange:g,onRowDblclick:h(l).onTableDblclick},w.$attrs),{default:T(()=>[be(w.$slots,"columnPrepend",{},void 0,!0),(p(!0),V(X,null,ce(h(l).table.column,(Y,G)=>(p(),V(X,null,[Y.show!==!1?(p(),V(X,{key:0},[Y.render=="slot"?be(w.$slots,Y.slotName,{key:0},void 0,!0):(p(),A(b,ge({key:G+"-column",ref_for:!0},Y,{"column-key":(Y.columnKey?Y.columnKey:`table-column-${Y.prop}`)||h(fo)()}),Ct({_:2},[Y.render?{name:"default",fn:T(H=>[(p(),A(It(r[Y.render]??r.default),{row:H.row,field:Y,column:H.column,index:H.$index,key:c(G,Y,H)},null,8,["row","field","column","index"]))]),key:"0"}:void 0]),1040,["column-key"]))],64)):M("",!0)],64))),256)),be(w.$slots,"columnAppend",{},void 0,!0)]),_:3},16,["default-expand-all","data","row-key","onRowDblclick"])),[[O,h(l).table.loading]]),a.pagination?(p(),V("div",ul,[k(v,{currentPage:h(l).table.filter.page,"page-size":h(l).table.filter.limit,"page-sizes":_.value,background:"",layout:h(t).layout.shrink?"prev, next, jumper":"sizes,total, ->, prev, pager, next, jumper",total:h(l).table.total,onSizeChange:u,onCurrentChange:m},null,8,["currentPage","page-size","page-sizes","layout","total"])])):M("",!0),be(w.$slots,"footer",{},void 0,!0)])}}}),dl=re(cl,[["__scopeId","data-v-7145c785"]]),fl={class:"table-com-search"},pl={key:0,class:"com-search-col-label"},hl={class:"com-search-col-input"},ml={key:0,class:"com-search-col-label w16"},gl={class:"com-search-col-input-range w83"},bl={key:0,class:"com-search-col-label"},vl={key:1,class:"com-search-col-input-range"},yl={class:"range-separator"},_l={key:2,class:"com-search-col-input"},wl={key:3,class:"com-search-col-input"},Sl={class:"com-search-col pl-20"},Tl=Z({__name:"index",setup(n){const e=at("baTable"),t=()=>{e.initComSearch(),e.onTableAction("com-search",{})};return(o,l)=>{const a=D("el-col"),r=D("el-date-picker"),i=D("el-input"),c=D("el-checkbox"),u=D("el-option"),m=D("el-select"),g=D("el-button"),_=D("el-row"),y=D("el-form"),d=Ye("blur");return p(),V("div",fl,[k(y,{onSubmit:l[2]||(l[2]=nt(()=>{},["prevent"])),onKeyup:l[3]||(l[3]=po(s=>h(e).onTableAction("com-search",{}),["enter"])),"label-position":"top",model:h(e).comSearch.form},{default:T(()=>[k(_,null,{default:T(()=>[(p(!0),V(X,null,ce(h(e).table.column,(s,E)=>{var F,R,x,L;return p(),V(X,{key:E},[s.operator!==!1?(p(),V(X,{key:0},[s.comSearchRender=="customRender"||s.comSearchRender=="slot"?(p(),A(a,ge({key:0,ref_for:!0},{xs:(F=s.comSearchColAttr)!=null&&F.xs?(R=s.comSearchColAttr)==null?void 0:R.xs:24,sm:(x=s.comSearchColAttr)!=null&&x.sm?(L=s.comSearchColAttr)==null?void 0:L.sm:6,...s.comSearchColAttr}),{default:T(()=>[B("div",{class:Ie(["com-search-col",s.prop])},[s.comSearchShowLabel!==!1?(p(),V("div",pl,j(s.label),1)):M("",!0),B("div",hl,[s.comSearchRender=="customRender"?(p(),A(It(s.comSearchCustomRender),{key:0,renderRow:s,renderField:s.prop,renderValue:h(e).comSearch.form[s.prop]},null,8,["renderRow","renderField","renderValue"])):s.comSearchRender=="slot"?be(o.$slots,s.comSearchSlotName,{key:1},void 0,!0):M("",!0)])],2)]),_:2},1040)):s.render=="datetime"&&(s.operator=="RANGE"||s.operator=="NOT RANGE")?(p(),A(a,{key:1,xs:24,sm:12},{default:T(()=>[B("div",{class:Ie(["com-search-col",s.prop])},[s.comSearchShowLabel!==!1?(p(),V("div",ml,j(s.label),1)):M("",!0),B("div",gl,[k(r,{class:"datetime-picker w100",modelValue:h(e).comSearch.form[s.prop],"onUpdate:modelValue":I=>h(e).comSearch.form[s.prop]=I,"default-time":[new Date(2e3,1,1,0,0,0),new Date(2e3,1,1,23,59,59)],type:s.comSearchRender=="date"?"daterange":"datetimerange","range-separator":o.$t("To"),"start-placeholder":o.$t("el.datepicker.startDate"),"end-placeholder":o.$t("el.datepicker.endDate"),"value-format":s.comSearchRender=="date"?"YYYY-MM-DD":"YYYY-MM-DD HH:mm:ss",teleported:!1},null,8,["modelValue","onUpdate:modelValue","default-time","type","range-separator","start-placeholder","end-placeholder","value-format"])])],2)]),_:2},1024)):(p(),A(a,{key:2,xs:24,sm:6},{default:T(()=>[B("div",{class:Ie(["com-search-col",s.prop])},[s.comSearchShowLabel!==!1?(p(),V("div",bl,j(s.label),1)):M("",!0),s.operator=="RANGE"||s.operator=="NOT RANGE"?(p(),V("div",vl,[k(i,{placeholder:s.operatorPlaceholder,type:"string",modelValue:h(e).comSearch.form[s.prop+"-start"],"onUpdate:modelValue":I=>h(e).comSearch.form[s.prop+"-start"]=I,clearable:!0},null,8,["placeholder","modelValue","onUpdate:modelValue"]),B("div",yl,j(o.$t("To")),1),k(i,{placeholder:s.operatorPlaceholder,type:"string",modelValue:h(e).comSearch.form[s.prop+"-end"],"onUpdate:modelValue":I=>h(e).comSearch.form[s.prop+"-end"]=I,clearable:!0},null,8,["placeholder","modelValue","onUpdate:modelValue"])])):s.operator=="NULL"||s.operator=="NOT NULL"?(p(),V("div",_l,[k(c,{modelValue:h(e).comSearch.form[s.prop],"onUpdate:modelValue":I=>h(e).comSearch.form[s.prop]=I,label:s.operator,size:"large"},null,8,["modelValue","onUpdate:modelValue","label"])])):s.operator?(p(),V("div",wl,[s.render=="datetime"||s.comSearchRender=="date"?(p(),A(r,{key:0,class:"datetime-picker w100",modelValue:h(e).comSearch.form[s.prop],"onUpdate:modelValue":I=>h(e).comSearch.form[s.prop]=I,type:s.comSearchRender=="date"?"date":"datetime","value-format":s.comSearchRender=="date"?"YYYY-MM-DD":"YYYY-MM-DD HH:mm:ss",placeholder:s.operatorPlaceholder,teleported:!1},null,8,["modelValue","onUpdate:modelValue","type","value-format","placeholder"])):(s.render=="tag"||s.render=="tags"||s.comSearchRender=="select")&&s.replaceValue?(p(),A(m,{key:1,class:"w100",placeholder:s.operatorPlaceholder,modelValue:h(e).comSearch.form[s.prop],"onUpdate:modelValue":I=>h(e).comSearch.form[s.prop]=I,multiple:s.operator=="IN"||s.operator=="NOT IN",clearable:!0},{default:T(()=>[(p(!0),V(X,null,ce(s.replaceValue,(I,w)=>(p(),A(u,{key:s.prop+w,label:I,value:w},null,8,["label","value"]))),128))]),_:2},1032,["placeholder","modelValue","onUpdate:modelValue","multiple"])):s.comSearchRender=="remoteSelect"?(p(),A(Da,{key:2,type:"remoteSelect",modelValue:h(e).comSearch.form[s.prop],"onUpdate:modelValue":I=>h(e).comSearch.form[s.prop]=I,attr:s.remote,placeholder:s.operatorPlaceholder},null,8,["modelValue","onUpdate:modelValue","attr","placeholder"])):s.render=="switch"?(p(),A(m,{key:3,placeholder:s.operatorPlaceholder,modelValue:h(e).comSearch.form[s.prop],"onUpdate:modelValue":I=>h(e).comSearch.form[s.prop]=I,clearable:!0,class:"w100"},{default:T(()=>[h(we)(s.replaceValue)?(p(),V(X,{key:1},[k(u,{label:o.$t("utils.open"),value:"1"},null,8,["label"]),k(u,{label:o.$t("utils.close"),value:"0"},null,8,["label"])],64)):(p(!0),V(X,{key:0},ce(s.replaceValue,(I,w)=>(p(),A(u,{key:s.prop+w,label:I,value:w},null,8,["label","value"]))),128))]),_:2},1032,["placeholder","modelValue","onUpdate:modelValue"])):(p(),A(i,{key:4,placeholder:s.operatorPlaceholder,type:"string",modelValue:h(e).comSearch.form[s.prop],"onUpdate:modelValue":I=>h(e).comSearch.form[s.prop]=I,clearable:!0},null,8,["placeholder","modelValue","onUpdate:modelValue"]))])):M("",!0)],2)]),_:2},1024))],64)):M("",!0)],64)}),128)),k(a,{xs:24,sm:6},{default:T(()=>[B("div",Sl,[ne((p(),A(g,{onClick:l[0]||(l[0]=s=>h(e).onTableAction("com-search",{})),type:"primary"},{default:T(()=>[_e(j(o.$t("Search")),1)]),_:1})),[[d]]),k(g,{onClick:l[1]||(l[1]=s=>t())},{default:T(()=>[_e(j(o.$t("Reset")),1)]),_:1})])]),_:1})]),_:3})]),_:3},8,["model"])])}}}),kl=re(Tl,[["__scopeId","data-v-3914b51f"]]),El={class:"table-header-operate-text"},Dl={class:"table-header-operate-text"},Il={class:"mlr-12"},Vl={class:"table-header-operate-text"},Cl={class:"table-header-operate-text"},Al={class:"table-search"},Ol={key:1,class:"table-search-button-group"},Rl=Z({__name:"index",props:{buttons:{default:()=>["refresh","add","edit","delete"]},quickSearchPlaceholder:{default:""}},setup(n){const{t:e}=Et.useI18n(),t=at("baTable"),o=n,l=se(()=>{let u=[];for(let m of t.table.column)m.type==="selection"||m.render==="buttons"||m.enableColumnDisplayControl===!1||u.push(m);return u}),a=se(()=>t.table.selection.length>0),r=(u,m={})=>{t.onTableHeaderAction(u,m)},i=ho(()=>{t.onTableHeaderAction("quick-search",{keyword:t.table.filter.quickSearch})},500),c=(u,m)=>{t.onTableHeaderAction("change-show-column",{field:m,value:u})};return(u,m)=>{const g=D("Icon"),_=D("el-button"),y=D("el-tooltip"),d=D("el-popconfirm"),s=D("el-input"),E=D("el-checkbox"),F=D("el-dropdown-item"),R=D("el-dropdown-menu"),x=D("el-dropdown"),L=Ye("blur");return p(),V(X,null,[k(Wo,{name:"el-zoom-in-bottom",mode:"out-in"},{default:T(()=>[ne(k(kl,null,Ct({_:2},[ce(u.$slots,(I,w)=>({name:w,fn:T(()=>[be(u.$slots,w,{},void 0,!0)])}))]),1536),[[Xo,o.buttons.includes("comSearch")&&h(t).table.showComSearch]])]),_:3}),B("div",ge(u.$attrs,{class:"table-header ba-scroll-style"}),[be(u.$slots,"refreshPrepend",{},void 0,!0),o.buttons.includes("refresh")?(p(),A(y,{key:0,content:h(e)("Refresh"),placement:"top"},{default:T(()=>[ne((p(),A(_,{onClick:m[0]||(m[0]=I=>r("refresh",{loading:!0})),color:"#40485b",class:"table-header-operate",type:"info"},{default:T(()=>[k(g,{name:"fa fa-refresh"})]),_:1})),[[L]])]),_:1},8,["content"])):M("",!0),be(u.$slots,"refreshAppend",{},void 0,!0),o.buttons.includes("add")&&h(t).auth("add")?(p(),A(y,{key:1,content:h(e)("Add"),placement:"top"},{default:T(()=>[ne((p(),A(_,{onClick:m[1]||(m[1]=I=>r("add")),class:"table-header-operate",type:"primary"},{default:T(()=>[k(g,{name:"fa fa-plus"}),B("span",El,j(h(e)("Add")),1)]),_:1})),[[L]])]),_:1},8,["content"])):M("",!0),o.buttons.includes("edit")&&h(t).auth("edit")?(p(),A(y,{key:2,content:h(e)("Edit selected row"),placement:"top"},{default:T(()=>[ne((p(),A(_,{onClick:m[2]||(m[2]=I=>r("edit")),disabled:!a.value,class:"table-header-operate",type:"primary"},{default:T(()=>[k(g,{name:"fa fa-pencil"}),B("span",Dl,j(h(e)("Edit")),1)]),_:1},8,["disabled"])),[[L]])]),_:1},8,["content"])):M("",!0),o.buttons.includes("delete")&&h(t).auth("del")?(p(),A(d,{key:3,onConfirm:m[3]||(m[3]=I=>r("delete")),"confirm-button-text":h(e)("Delete"),"cancel-button-text":h(e)("Cancel"),confirmButtonType:"danger",title:h(e)("Are you sure to delete the selected record?"),disabled:!a.value},{reference:T(()=>[B("div",Il,[k(y,{content:h(e)("Delete selected row"),placement:"top"},{default:T(()=>[ne((p(),A(_,{disabled:!a.value,class:"table-header-operate",type:"danger"},{default:T(()=>[k(g,{name:"fa fa-trash"}),B("span",Vl,j(h(e)("Delete")),1)]),_:1},8,["disabled"])),[[L]])]),_:1},8,["content"])])]),_:1},8,["confirm-button-text","cancel-button-text","title","disabled"])):M("",!0),o.buttons.includes("unfold")?(p(),A(y,{key:4,content:(h(t).table.expandAll?h(e)("Shrink"):h(e)("Open"))+h(e)("All submenus"),placement:"top"},{default:T(()=>[ne((p(),A(_,{onClick:m[4]||(m[4]=I=>h(t).onTableHeaderAction("unfold",{unfold:!h(t).table.expandAll})),class:"table-header-operate",type:h(t).table.expandAll?"danger":"warning"},{default:T(()=>[B("span",Cl,j(h(t).table.expandAll?h(e)("Shrink all"):h(e)("Expand all")),1)]),_:1},8,["type"])),[[L]])]),_:1},8,["content"])):M("",!0),be(u.$slots,"default",{},void 0,!0),B("div",Al,[be(u.$slots,"quickSearchPrepend",{},void 0,!0),o.buttons.includes("quickSearch")?(p(),A(s,{key:0,modelValue:h(t).table.filter.quickSearch,"onUpdate:modelValue":m[5]||(m[5]=I=>h(t).table.filter.quickSearch=I),class:"xs-hidden quick-search",onInput:h(i),placeholder:u.quickSearchPlaceholder?u.quickSearchPlaceholder:h(e)("Search"),clearable:""},null,8,["modelValue","onInput","placeholder"])):M("",!0),o.buttons.includes("columnDisplay")||o.buttons.includes("comSearch")?(p(),V("div",Ol,[o.buttons.includes("columnDisplay")?(p(),A(x,{key:0,"max-height":380,"hide-on-click":!1},{dropdown:T(()=>[k(R,null,{default:T(()=>[(p(!0),V(X,null,ce(l.value,(I,w)=>(p(),A(F,{key:w},{default:T(()=>[I.prop?(p(),A(E,{key:0,onChange:f=>c(f,I.prop),checked:!I.show,"model-value":I.show,size:"small",label:I.label},null,8,["onChange","checked","model-value","label"])):M("",!0)]),_:2},1024))),128))]),_:1})]),default:T(()=>[ne((p(),A(_,{class:Ie(["table-search-button-item",o.buttons.includes("comSearch")?"right-border":""]),color:"#dcdfe6",plain:""},{default:T(()=>[k(g,{size:"14",name:"el-icon-Grid"})]),_:1},8,["class"])),[[L]])]),_:1})):M("",!0),o.buttons.includes("comSearch")?(p(),A(y,{key:1,disabled:h(t).table.showComSearch,content:h(e)("Expand generic search"),placement:"top"},{default:T(()=>[ne((p(),A(_,{class:"table-search-button-item",onClick:m[6]||(m[6]=I=>h(t).table.showComSearch=!h(t).table.showComSearch),color:"#dcdfe6",plain:""},{default:T(()=>[k(g,{size:"14",name:"el-icon-Search"})]),_:1})),[[L]])]),_:1},8,["disabled","content"])):M("",!0)])):M("",!0)])],16)],64)}}}),Nl=re(Rl,[["__scopeId","data-v-c9d99de7"]]);/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function to(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(n,l).enumerable})),t.push.apply(t,o)}return t}function De(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?to(Object(t),!0).forEach(function(o){Pl(n,o,t[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):to(Object(t)).forEach(function(o){Object.defineProperty(n,o,Object.getOwnPropertyDescriptor(t,o))})}return n}function mt(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?mt=function(e){return typeof e}:mt=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mt(n)}function Pl(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ce(){return Ce=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o])}return n},Ce.apply(this,arguments)}function $l(n,e){if(n==null)return{};var t={},o=Object.keys(n),l,a;for(a=0;a<o.length;a++)l=o[a],!(e.indexOf(l)>=0)&&(t[l]=n[l]);return t}function Ml(n,e){if(n==null)return{};var t=$l(n,e),o,l;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);for(l=0;l<a.length;l++)o=a[l],!(e.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(n,o)&&(t[o]=n[o])}return t}var Fl="1.15.6";function Ve(n){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(n)}var Ae=Ve(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),rt=Ve(/Edge/i),oo=Ve(/firefox/i),Ze=Ve(/safari/i)&&!Ve(/chrome/i)&&!Ve(/android/i),qt=Ve(/iP(ad|od|hone)/i),yo=Ve(/chrome/i)&&Ve(/android/i),_o={capture:!1,passive:!1};function z(n,e,t){n.addEventListener(e,t,!Ae&&_o)}function U(n,e,t){n.removeEventListener(e,t,!Ae&&_o)}function _t(n,e){if(e){if(e[0]===">"&&(e=e.substring(1)),n)try{if(n.matches)return n.matches(e);if(n.msMatchesSelector)return n.msMatchesSelector(e);if(n.webkitMatchesSelector)return n.webkitMatchesSelector(e)}catch{return!1}return!1}}function wo(n){return n.host&&n!==document&&n.host.nodeType?n.host:n.parentNode}function ye(n,e,t,o){if(n){t=t||document;do{if(e!=null&&(e[0]===">"?n.parentNode===t&&_t(n,e):_t(n,e))||o&&n===t)return n;if(n===t)break}while(n=wo(n))}return null}var no=/\s+/g;function de(n,e,t){if(n&&e)if(n.classList)n.classList[t?"add":"remove"](e);else{var o=(" "+n.className+" ").replace(no," ").replace(" "+e+" "," ");n.className=(o+(t?" "+e:"")).replace(no," ")}}function P(n,e,t){var o=n&&n.style;if(o){if(t===void 0)return document.defaultView&&document.defaultView.getComputedStyle?t=document.defaultView.getComputedStyle(n,""):n.currentStyle&&(t=n.currentStyle),e===void 0?t:t[e];!(e in o)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),o[e]=t+(typeof t=="string"?"":"px")}}function qe(n,e){var t="";if(typeof n=="string")t=n;else do{var o=P(n,"transform");o&&o!=="none"&&(t=o+" "+t)}while(!e&&(n=n.parentNode));var l=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return l&&new l(t)}function So(n,e,t){if(n){var o=n.getElementsByTagName(e),l=0,a=o.length;if(t)for(;l<a;l++)t(o[l],l);return o}return[]}function Ee(){var n=document.scrollingElement;return n||document.documentElement}function te(n,e,t,o,l){if(!(!n.getBoundingClientRect&&n!==window)){var a,r,i,c,u,m,g;if(n!==window&&n.parentNode&&n!==Ee()?(a=n.getBoundingClientRect(),r=a.top,i=a.left,c=a.bottom,u=a.right,m=a.height,g=a.width):(r=0,i=0,c=window.innerHeight,u=window.innerWidth,m=window.innerHeight,g=window.innerWidth),(e||t)&&n!==window&&(l=l||n.parentNode,!Ae))do if(l&&l.getBoundingClientRect&&(P(l,"transform")!=="none"||t&&P(l,"position")!=="static")){var _=l.getBoundingClientRect();r-=_.top+parseInt(P(l,"border-top-width")),i-=_.left+parseInt(P(l,"border-left-width")),c=r+a.height,u=i+a.width;break}while(l=l.parentNode);if(o&&n!==window){var y=qe(l||n),d=y&&y.a,s=y&&y.d;y&&(r/=s,i/=d,g/=d,m/=s,c=r+m,u=i+g)}return{top:r,left:i,bottom:c,right:u,width:g,height:m}}}function lo(n,e,t){for(var o=Ne(n,!0),l=te(n)[e];o;){var a=te(o)[t],r=void 0;if(r=l>=a,!r)return o;if(o===Ee())break;o=Ne(o,!1)}return!1}function Ke(n,e,t,o){for(var l=0,a=0,r=n.children;a<r.length;){if(r[a].style.display!=="none"&&r[a]!==N.ghost&&(o||r[a]!==N.dragged)&&ye(r[a],t.draggable,n,!1)){if(l===e)return r[a];l++}a++}return null}function Kt(n,e){for(var t=n.lastElementChild;t&&(t===N.ghost||P(t,"display")==="none"||e&&!_t(t,e));)t=t.previousElementSibling;return t||null}function me(n,e){var t=0;if(!n||!n.parentNode)return-1;for(;n=n.previousElementSibling;)n.nodeName.toUpperCase()!=="TEMPLATE"&&n!==N.clone&&(!e||_t(n,e))&&t++;return t}function ao(n){var e=0,t=0,o=Ee();if(n)do{var l=qe(n),a=l.a,r=l.d;e+=n.scrollLeft*a,t+=n.scrollTop*r}while(n!==o&&(n=n.parentNode));return[e,t]}function xl(n,e){for(var t in n)if(n.hasOwnProperty(t)){for(var o in e)if(e.hasOwnProperty(o)&&e[o]===n[t][o])return Number(t)}return-1}function Ne(n,e){if(!n||!n.getBoundingClientRect)return Ee();var t=n,o=!1;do if(t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight){var l=P(t);if(t.clientWidth<t.scrollWidth&&(l.overflowX=="auto"||l.overflowX=="scroll")||t.clientHeight<t.scrollHeight&&(l.overflowY=="auto"||l.overflowY=="scroll")){if(!t.getBoundingClientRect||t===document.body)return Ee();if(o||e)return t;o=!0}}while(t=t.parentNode);return Ee()}function Ll(n,e){if(n&&e)for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function Nt(n,e){return Math.round(n.top)===Math.round(e.top)&&Math.round(n.left)===Math.round(e.left)&&Math.round(n.height)===Math.round(e.height)&&Math.round(n.width)===Math.round(e.width)}var Je;function To(n,e){return function(){if(!Je){var t=arguments,o=this;t.length===1?n.call(o,t[0]):n.apply(o,t),Je=setTimeout(function(){Je=void 0},e)}}}function Yl(){clearTimeout(Je),Je=void 0}function ko(n,e,t){n.scrollLeft+=e,n.scrollTop+=t}function Eo(n){var e=window.Polymer,t=window.jQuery||window.Zepto;return e&&e.dom?e.dom(n).cloneNode(!0):t?t(n).clone(!0)[0]:n.cloneNode(!0)}function Do(n,e,t){var o={};return Array.from(n.children).forEach(function(l){var a,r,i,c;if(!(!ye(l,e.draggable,n,!1)||l.animated||l===t)){var u=te(l);o.left=Math.min((a=o.left)!==null&&a!==void 0?a:1/0,u.left),o.top=Math.min((r=o.top)!==null&&r!==void 0?r:1/0,u.top),o.right=Math.max((i=o.right)!==null&&i!==void 0?i:-1/0,u.right),o.bottom=Math.max((c=o.bottom)!==null&&c!==void 0?c:-1/0,u.bottom)}}),o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}var ue="Sortable"+new Date().getTime();function Ul(){var n=[],e;return{captureAnimationState:function(){if(n=[],!!this.options.animation){var o=[].slice.call(this.el.children);o.forEach(function(l){if(!(P(l,"display")==="none"||l===N.ghost)){n.push({target:l,rect:te(l)});var a=De({},n[n.length-1].rect);if(l.thisAnimationDuration){var r=qe(l,!0);r&&(a.top-=r.f,a.left-=r.e)}l.fromRect=a}})}},addAnimationState:function(o){n.push(o)},removeAnimationState:function(o){n.splice(xl(n,{target:o}),1)},animateAll:function(o){var l=this;if(!this.options.animation){clearTimeout(e),typeof o=="function"&&o();return}var a=!1,r=0;n.forEach(function(i){var c=0,u=i.target,m=u.fromRect,g=te(u),_=u.prevFromRect,y=u.prevToRect,d=i.rect,s=qe(u,!0);s&&(g.top-=s.f,g.left-=s.e),u.toRect=g,u.thisAnimationDuration&&Nt(_,g)&&!Nt(m,g)&&(d.top-g.top)/(d.left-g.left)===(m.top-g.top)/(m.left-g.left)&&(c=Bl(d,_,y,l.options)),Nt(g,m)||(u.prevFromRect=m,u.prevToRect=g,c||(c=l.options.animation),l.animate(u,d,g,c)),c&&(a=!0,r=Math.max(r,c),clearTimeout(u.animationResetTimer),u.animationResetTimer=setTimeout(function(){u.animationTime=0,u.prevFromRect=null,u.fromRect=null,u.prevToRect=null,u.thisAnimationDuration=null},c),u.thisAnimationDuration=c)}),clearTimeout(e),a?e=setTimeout(function(){typeof o=="function"&&o()},r):typeof o=="function"&&o(),n=[]},animate:function(o,l,a,r){if(r){P(o,"transition",""),P(o,"transform","");var i=qe(this.el),c=i&&i.a,u=i&&i.d,m=(l.left-a.left)/(c||1),g=(l.top-a.top)/(u||1);o.animatingX=!!m,o.animatingY=!!g,P(o,"transform","translate3d("+m+"px,"+g+"px,0)"),this.forRepaintDummy=zl(o),P(o,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),P(o,"transform","translate3d(0,0,0)"),typeof o.animated=="number"&&clearTimeout(o.animated),o.animated=setTimeout(function(){P(o,"transition",""),P(o,"transform",""),o.animated=!1,o.animatingX=!1,o.animatingY=!1},r)}}}}function zl(n){return n.offsetWidth}function Bl(n,e,t,o){return Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))/Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))*o.animation}var Ue=[],Pt={initializeByDefault:!0},it={mount:function(e){for(var t in Pt)Pt.hasOwnProperty(t)&&!(t in e)&&(e[t]=Pt[t]);Ue.forEach(function(o){if(o.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),Ue.push(e)},pluginEvent:function(e,t,o){var l=this;this.eventCanceled=!1,o.cancel=function(){l.eventCanceled=!0};var a=e+"Global";Ue.forEach(function(r){t[r.pluginName]&&(t[r.pluginName][a]&&t[r.pluginName][a](De({sortable:t},o)),t.options[r.pluginName]&&t[r.pluginName][e]&&t[r.pluginName][e](De({sortable:t},o)))})},initializePlugins:function(e,t,o,l){Ue.forEach(function(i){var c=i.pluginName;if(!(!e.options[c]&&!i.initializeByDefault)){var u=new i(e,t,e.options);u.sortable=e,u.options=e.options,e[c]=u,Ce(o,u.defaults)}});for(var a in e.options)if(e.options.hasOwnProperty(a)){var r=this.modifyOption(e,a,e.options[a]);typeof r<"u"&&(e.options[a]=r)}},getEventProperties:function(e,t){var o={};return Ue.forEach(function(l){typeof l.eventProperties=="function"&&Ce(o,l.eventProperties.call(t[l.pluginName],e))}),o},modifyOption:function(e,t,o){var l;return Ue.forEach(function(a){e[a.pluginName]&&a.optionListeners&&typeof a.optionListeners[t]=="function"&&(l=a.optionListeners[t].call(e[a.pluginName],o))}),l}};function jl(n){var e=n.sortable,t=n.rootEl,o=n.name,l=n.targetEl,a=n.cloneEl,r=n.toEl,i=n.fromEl,c=n.oldIndex,u=n.newIndex,m=n.oldDraggableIndex,g=n.newDraggableIndex,_=n.originalEvent,y=n.putSortable,d=n.extraEventProperties;if(e=e||t&&t[ue],!!e){var s,E=e.options,F="on"+o.charAt(0).toUpperCase()+o.substr(1);window.CustomEvent&&!Ae&&!rt?s=new CustomEvent(o,{bubbles:!0,cancelable:!0}):(s=document.createEvent("Event"),s.initEvent(o,!0,!0)),s.to=r||t,s.from=i||t,s.item=l||t,s.clone=a,s.oldIndex=c,s.newIndex=u,s.oldDraggableIndex=m,s.newDraggableIndex=g,s.originalEvent=_,s.pullMode=y?y.lastPutMode:void 0;var R=De(De({},d),it.getEventProperties(o,e));for(var x in R)s[x]=R[x];t&&t.dispatchEvent(s),E[F]&&E[F].call(e,s)}}var Hl=["evt"],ie=function(e,t){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l=o.evt,a=Ml(o,Hl);it.pluginEvent.bind(N)(e,t,De({dragEl:S,parentEl:Q,ghostEl:$,rootEl:K,nextEl:xe,lastDownEl:gt,cloneEl:W,cloneHidden:Re,dragStarted:Xe,putSortable:oe,activeSortable:N.active,originalEvent:l,oldIndex:je,oldDraggableIndex:et,newIndex:fe,newDraggableIndex:Oe,hideGhostForTarget:Ao,unhideGhostForTarget:Oo,cloneNowHidden:function(){Re=!0},cloneNowShown:function(){Re=!1},dispatchSortableEvent:function(i){ae({sortable:t,name:i,originalEvent:l})}},a))};function ae(n){jl(De({putSortable:oe,cloneEl:W,targetEl:S,rootEl:K,oldIndex:je,oldDraggableIndex:et,newIndex:fe,newDraggableIndex:Oe},n))}var S,Q,$,K,xe,gt,W,Re,je,fe,et,Oe,ut,oe,Be=!1,wt=!1,St=[],Me,ve,$t,Mt,ro,io,Xe,ze,tt,ot=!1,ct=!1,bt,le,Ft=[],Bt=!1,Tt=[],At=typeof document<"u",dt=qt,so=rt||Ae?"cssFloat":"float",Gl=At&&!yo&&!qt&&"draggable"in document.createElement("div"),Io=function(){if(At){if(Ae)return!1;var n=document.createElement("x");return n.style.cssText="pointer-events:auto",n.style.pointerEvents==="auto"}}(),Vo=function(e,t){var o=P(e),l=parseInt(o.width)-parseInt(o.paddingLeft)-parseInt(o.paddingRight)-parseInt(o.borderLeftWidth)-parseInt(o.borderRightWidth),a=Ke(e,0,t),r=Ke(e,1,t),i=a&&P(a),c=r&&P(r),u=i&&parseInt(i.marginLeft)+parseInt(i.marginRight)+te(a).width,m=c&&parseInt(c.marginLeft)+parseInt(c.marginRight)+te(r).width;if(o.display==="flex")return o.flexDirection==="column"||o.flexDirection==="column-reverse"?"vertical":"horizontal";if(o.display==="grid")return o.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(a&&i.float&&i.float!=="none"){var g=i.float==="left"?"left":"right";return r&&(c.clear==="both"||c.clear===g)?"vertical":"horizontal"}return a&&(i.display==="block"||i.display==="flex"||i.display==="table"||i.display==="grid"||u>=l&&o[so]==="none"||r&&o[so]==="none"&&u+m>l)?"vertical":"horizontal"},ql=function(e,t,o){var l=o?e.left:e.top,a=o?e.right:e.bottom,r=o?e.width:e.height,i=o?t.left:t.top,c=o?t.right:t.bottom,u=o?t.width:t.height;return l===i||a===c||l+r/2===i+u/2},Kl=function(e,t){var o;return St.some(function(l){var a=l[ue].options.emptyInsertThreshold;if(!(!a||Kt(l))){var r=te(l),i=e>=r.left-a&&e<=r.right+a,c=t>=r.top-a&&t<=r.bottom+a;if(i&&c)return o=l}}),o},Co=function(e){function t(a,r){return function(i,c,u,m){var g=i.options.group.name&&c.options.group.name&&i.options.group.name===c.options.group.name;if(a==null&&(r||g))return!0;if(a==null||a===!1)return!1;if(r&&a==="clone")return a;if(typeof a=="function")return t(a(i,c,u,m),r)(i,c,u,m);var _=(r?i:c).options.group.name;return a===!0||typeof a=="string"&&a===_||a.join&&a.indexOf(_)>-1}}var o={},l=e.group;(!l||mt(l)!="object")&&(l={name:l}),o.name=l.name,o.checkPull=t(l.pull,!0),o.checkPut=t(l.put),o.revertClone=l.revertClone,e.group=o},Ao=function(){!Io&&$&&P($,"display","none")},Oo=function(){!Io&&$&&P($,"display","")};At&&!yo&&document.addEventListener("click",function(n){if(wt)return n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.stopImmediatePropagation&&n.stopImmediatePropagation(),wt=!1,!1},!0);var Fe=function(e){if(S){e=e.touches?e.touches[0]:e;var t=Kl(e.clientX,e.clientY);if(t){var o={};for(var l in e)e.hasOwnProperty(l)&&(o[l]=e[l]);o.target=o.rootEl=t,o.preventDefault=void 0,o.stopPropagation=void 0,t[ue]._onDragOver(o)}}},Xl=function(e){S&&S.parentNode[ue]._isOutsideThisEl(e.target)};function N(n,e){if(!(n&&n.nodeType&&n.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(n));this.el=n,this.options=e=Ce({},e),n[ue]=this;var t={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(n.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Vo(n,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(r,i){r.setData("Text",i.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:N.supportPointer!==!1&&"PointerEvent"in window&&(!Ze||qt),emptyInsertThreshold:5};it.initializePlugins(this,n,t);for(var o in t)!(o in e)&&(e[o]=t[o]);Co(e);for(var l in this)l.charAt(0)==="_"&&typeof this[l]=="function"&&(this[l]=this[l].bind(this));this.nativeDraggable=e.forceFallback?!1:Gl,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?z(n,"pointerdown",this._onTapStart):(z(n,"mousedown",this._onTapStart),z(n,"touchstart",this._onTapStart)),this.nativeDraggable&&(z(n,"dragover",this),z(n,"dragenter",this)),St.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),Ce(this,Ul())}N.prototype={constructor:N,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(ze=null)},_getDirection:function(e,t){return typeof this.options.direction=="function"?this.options.direction.call(this,e,t,S):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,o=this.el,l=this.options,a=l.preventOnFilter,r=e.type,i=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,c=(i||e).target,u=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||c,m=l.filter;if(na(o),!S&&!(/mousedown|pointerdown/.test(r)&&e.button!==0||l.disabled)&&!u.isContentEditable&&!(!this.nativeDraggable&&Ze&&c&&c.tagName.toUpperCase()==="SELECT")&&(c=ye(c,l.draggable,o,!1),!(c&&c.animated)&&gt!==c)){if(je=me(c),et=me(c,l.draggable),typeof m=="function"){if(m.call(this,e,c,this)){ae({sortable:t,rootEl:u,name:"filter",targetEl:c,toEl:o,fromEl:o}),ie("filter",t,{evt:e}),a&&e.preventDefault();return}}else if(m&&(m=m.split(",").some(function(g){if(g=ye(u,g.trim(),o,!1),g)return ae({sortable:t,rootEl:g,name:"filter",targetEl:c,fromEl:o,toEl:o}),ie("filter",t,{evt:e}),!0}),m)){a&&e.preventDefault();return}l.handle&&!ye(u,l.handle,o,!1)||this._prepareDragStart(e,i,c)}}},_prepareDragStart:function(e,t,o){var l=this,a=l.el,r=l.options,i=a.ownerDocument,c;if(o&&!S&&o.parentNode===a){var u=te(o);if(K=a,S=o,Q=S.parentNode,xe=S.nextSibling,gt=o,ut=r.group,N.dragged=S,Me={target:S,clientX:(t||e).clientX,clientY:(t||e).clientY},ro=Me.clientX-u.left,io=Me.clientY-u.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,S.style["will-change"]="all",c=function(){if(ie("delayEnded",l,{evt:e}),N.eventCanceled){l._onDrop();return}l._disableDelayedDragEvents(),!oo&&l.nativeDraggable&&(S.draggable=!0),l._triggerDragStart(e,t),ae({sortable:l,name:"choose",originalEvent:e}),de(S,r.chosenClass,!0)},r.ignore.split(",").forEach(function(m){So(S,m.trim(),xt)}),z(i,"dragover",Fe),z(i,"mousemove",Fe),z(i,"touchmove",Fe),r.supportPointer?(z(i,"pointerup",l._onDrop),!this.nativeDraggable&&z(i,"pointercancel",l._onDrop)):(z(i,"mouseup",l._onDrop),z(i,"touchend",l._onDrop),z(i,"touchcancel",l._onDrop)),oo&&this.nativeDraggable&&(this.options.touchStartThreshold=4,S.draggable=!0),ie("delayStart",this,{evt:e}),r.delay&&(!r.delayOnTouchOnly||t)&&(!this.nativeDraggable||!(rt||Ae))){if(N.eventCanceled){this._onDrop();return}r.supportPointer?(z(i,"pointerup",l._disableDelayedDrag),z(i,"pointercancel",l._disableDelayedDrag)):(z(i,"mouseup",l._disableDelayedDrag),z(i,"touchend",l._disableDelayedDrag),z(i,"touchcancel",l._disableDelayedDrag)),z(i,"mousemove",l._delayedDragTouchMoveHandler),z(i,"touchmove",l._delayedDragTouchMoveHandler),r.supportPointer&&z(i,"pointermove",l._delayedDragTouchMoveHandler),l._dragStartTimer=setTimeout(c,r.delay)}else c()}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){S&&xt(S),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;U(e,"mouseup",this._disableDelayedDrag),U(e,"touchend",this._disableDelayedDrag),U(e,"touchcancel",this._disableDelayedDrag),U(e,"pointerup",this._disableDelayedDrag),U(e,"pointercancel",this._disableDelayedDrag),U(e,"mousemove",this._delayedDragTouchMoveHandler),U(e,"touchmove",this._delayedDragTouchMoveHandler),U(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||e.pointerType=="touch"&&e,!this.nativeDraggable||t?this.options.supportPointer?z(document,"pointermove",this._onTouchMove):t?z(document,"touchmove",this._onTouchMove):z(document,"mousemove",this._onTouchMove):(z(S,"dragend",this),z(K,"dragstart",this._onDragStart));try{document.selection?vt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,t){if(Be=!1,K&&S){ie("dragStarted",this,{evt:t}),this.nativeDraggable&&z(document,"dragover",Xl);var o=this.options;!e&&de(S,o.dragClass,!1),de(S,o.ghostClass,!0),N.active=this,e&&this._appendGhost(),ae({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(ve){this._lastX=ve.clientX,this._lastY=ve.clientY,Ao();for(var e=document.elementFromPoint(ve.clientX,ve.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(ve.clientX,ve.clientY),e!==t);)t=e;if(S.parentNode[ue]._isOutsideThisEl(e),t)do{if(t[ue]){var o=void 0;if(o=t[ue]._onDragOver({clientX:ve.clientX,clientY:ve.clientY,target:e,rootEl:t}),o&&!this.options.dragoverBubble)break}e=t}while(t=wo(t));Oo()}},_onTouchMove:function(e){if(Me){var t=this.options,o=t.fallbackTolerance,l=t.fallbackOffset,a=e.touches?e.touches[0]:e,r=$&&qe($,!0),i=$&&r&&r.a,c=$&&r&&r.d,u=dt&&le&&ao(le),m=(a.clientX-Me.clientX+l.x)/(i||1)+(u?u[0]-Ft[0]:0)/(i||1),g=(a.clientY-Me.clientY+l.y)/(c||1)+(u?u[1]-Ft[1]:0)/(c||1);if(!N.active&&!Be){if(o&&Math.max(Math.abs(a.clientX-this._lastX),Math.abs(a.clientY-this._lastY))<o)return;this._onDragStart(e,!0)}if($){r?(r.e+=m-($t||0),r.f+=g-(Mt||0)):r={a:1,b:0,c:0,d:1,e:m,f:g};var _="matrix(".concat(r.a,",").concat(r.b,",").concat(r.c,",").concat(r.d,",").concat(r.e,",").concat(r.f,")");P($,"webkitTransform",_),P($,"mozTransform",_),P($,"msTransform",_),P($,"transform",_),$t=m,Mt=g,ve=a}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!$){var e=this.options.fallbackOnBody?document.body:K,t=te(S,!0,dt,!0,e),o=this.options;if(dt){for(le=e;P(le,"position")==="static"&&P(le,"transform")==="none"&&le!==document;)le=le.parentNode;le!==document.body&&le!==document.documentElement?(le===document&&(le=Ee()),t.top+=le.scrollTop,t.left+=le.scrollLeft):le=Ee(),Ft=ao(le)}$=S.cloneNode(!0),de($,o.ghostClass,!1),de($,o.fallbackClass,!0),de($,o.dragClass,!0),P($,"transition",""),P($,"transform",""),P($,"box-sizing","border-box"),P($,"margin",0),P($,"top",t.top),P($,"left",t.left),P($,"width",t.width),P($,"height",t.height),P($,"opacity","0.8"),P($,"position",dt?"absolute":"fixed"),P($,"zIndex","100000"),P($,"pointerEvents","none"),N.ghost=$,e.appendChild($),P($,"transform-origin",ro/parseInt($.style.width)*100+"% "+io/parseInt($.style.height)*100+"%")}},_onDragStart:function(e,t){var o=this,l=e.dataTransfer,a=o.options;if(ie("dragStart",this,{evt:e}),N.eventCanceled){this._onDrop();return}ie("setupClone",this),N.eventCanceled||(W=Eo(S),W.removeAttribute("id"),W.draggable=!1,W.style["will-change"]="",this._hideClone(),de(W,this.options.chosenClass,!1),N.clone=W),o.cloneId=vt(function(){ie("clone",o),!N.eventCanceled&&(o.options.removeCloneOnHide||K.insertBefore(W,S),o._hideClone(),ae({sortable:o,name:"clone"}))}),!t&&de(S,a.dragClass,!0),t?(wt=!0,o._loopId=setInterval(o._emulateDragOver,50)):(U(document,"mouseup",o._onDrop),U(document,"touchend",o._onDrop),U(document,"touchcancel",o._onDrop),l&&(l.effectAllowed="move",a.setData&&a.setData.call(o,l,S)),z(document,"drop",o),P(S,"transform","translateZ(0)")),Be=!0,o._dragStartId=vt(o._dragStarted.bind(o,t,e)),z(document,"selectstart",o),Xe=!0,window.getSelection().removeAllRanges(),Ze&&P(document.body,"user-select","none")},_onDragOver:function(e){var t=this.el,o=e.target,l,a,r,i=this.options,c=i.group,u=N.active,m=ut===c,g=i.sort,_=oe||u,y,d=this,s=!1;if(Bt)return;function E($e,st){ie($e,d,De({evt:e,isOwner:m,axis:y?"vertical":"horizontal",revert:r,dragRect:l,targetRect:a,canSort:g,fromSortable:_,target:o,completed:R,onMove:function(Qt,No){return ft(K,t,S,l,Qt,te(Qt),e,No)},changed:x},st))}function F(){E("dragOverAnimationCapture"),d.captureAnimationState(),d!==_&&_.captureAnimationState()}function R($e){return E("dragOverCompleted",{insertion:$e}),$e&&(m?u._hideClone():u._showClone(d),d!==_&&(de(S,oe?oe.options.ghostClass:u.options.ghostClass,!1),de(S,i.ghostClass,!0)),oe!==d&&d!==N.active?oe=d:d===N.active&&oe&&(oe=null),_===d&&(d._ignoreWhileAnimating=o),d.animateAll(function(){E("dragOverAnimationComplete"),d._ignoreWhileAnimating=null}),d!==_&&(_.animateAll(),_._ignoreWhileAnimating=null)),(o===S&&!S.animated||o===t&&!o.animated)&&(ze=null),!i.dragoverBubble&&!e.rootEl&&o!==document&&(S.parentNode[ue]._isOutsideThisEl(e.target),!$e&&Fe(e)),!i.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),s=!0}function x(){fe=me(S),Oe=me(S,i.draggable),ae({sortable:d,name:"change",toEl:t,newIndex:fe,newDraggableIndex:Oe,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),o=ye(o,i.draggable,t,!0),E("dragOver"),N.eventCanceled)return s;if(S.contains(e.target)||o.animated&&o.animatingX&&o.animatingY||d._ignoreWhileAnimating===o)return R(!1);if(wt=!1,u&&!i.disabled&&(m?g||(r=Q!==K):oe===this||(this.lastPutMode=ut.checkPull(this,u,S,e))&&c.checkPut(this,u,S,e))){if(y=this._getDirection(e,o)==="vertical",l=te(S),E("dragOverValid"),N.eventCanceled)return s;if(r)return Q=K,F(),this._hideClone(),E("revert"),N.eventCanceled||(xe?K.insertBefore(S,xe):K.appendChild(S)),R(!0);var L=Kt(t,i.draggable);if(!L||Jl(e,y,this)&&!L.animated){if(L===S)return R(!1);if(L&&t===e.target&&(o=L),o&&(a=te(o)),ft(K,t,S,l,o,a,e,!!o)!==!1)return F(),L&&L.nextSibling?t.insertBefore(S,L.nextSibling):t.appendChild(S),Q=t,x(),R(!0)}else if(L&&Zl(e,y,this)){var I=Ke(t,0,i,!0);if(I===S)return R(!1);if(o=I,a=te(o),ft(K,t,S,l,o,a,e,!1)!==!1)return F(),t.insertBefore(S,I),Q=t,x(),R(!0)}else if(o.parentNode===t){a=te(o);var w=0,f,b=S.parentNode!==t,C=!ql(S.animated&&S.toRect||l,o.animated&&o.toRect||a,y),v=y?"top":"left",O=lo(o,"top","top")||lo(S,"top","top"),Y=O?O.scrollTop:void 0;ze!==o&&(f=a[v],ot=!1,ct=!C&&i.invertSwap||b),w=ea(e,o,a,y,C?1:i.swapThreshold,i.invertedSwapThreshold==null?i.swapThreshold:i.invertedSwapThreshold,ct,ze===o);var G;if(w!==0){var H=me(S);do H-=w,G=Q.children[H];while(G&&(P(G,"display")==="none"||G===$))}if(w===0||G===o)return R(!1);ze=o,tt=w;var Te=o.nextElementSibling,pe=!1;pe=w===1;var he=ft(K,t,S,l,o,a,e,pe);if(he!==!1)return(he===1||he===-1)&&(pe=he===1),Bt=!0,setTimeout(Ql,30),F(),pe&&!Te?t.appendChild(S):o.parentNode.insertBefore(S,pe?Te:o),O&&ko(O,0,Y-O.scrollTop),Q=S.parentNode,f!==void 0&&!ct&&(bt=Math.abs(f-te(o)[v])),x(),R(!0)}if(t.contains(S))return R(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){U(document,"mousemove",this._onTouchMove),U(document,"touchmove",this._onTouchMove),U(document,"pointermove",this._onTouchMove),U(document,"dragover",Fe),U(document,"mousemove",Fe),U(document,"touchmove",Fe)},_offUpEvents:function(){var e=this.el.ownerDocument;U(e,"mouseup",this._onDrop),U(e,"touchend",this._onDrop),U(e,"pointerup",this._onDrop),U(e,"pointercancel",this._onDrop),U(e,"touchcancel",this._onDrop),U(document,"selectstart",this)},_onDrop:function(e){var t=this.el,o=this.options;if(fe=me(S),Oe=me(S,o.draggable),ie("drop",this,{evt:e}),Q=S&&S.parentNode,fe=me(S),Oe=me(S,o.draggable),N.eventCanceled){this._nulling();return}Be=!1,ct=!1,ot=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),jt(this.cloneId),jt(this._dragStartId),this.nativeDraggable&&(U(document,"drop",this),U(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),Ze&&P(document.body,"user-select",""),P(S,"transform",""),e&&(Xe&&(e.cancelable&&e.preventDefault(),!o.dropBubble&&e.stopPropagation()),$&&$.parentNode&&$.parentNode.removeChild($),(K===Q||oe&&oe.lastPutMode!=="clone")&&W&&W.parentNode&&W.parentNode.removeChild(W),S&&(this.nativeDraggable&&U(S,"dragend",this),xt(S),S.style["will-change"]="",Xe&&!Be&&de(S,oe?oe.options.ghostClass:this.options.ghostClass,!1),de(S,this.options.chosenClass,!1),ae({sortable:this,name:"unchoose",toEl:Q,newIndex:null,newDraggableIndex:null,originalEvent:e}),K!==Q?(fe>=0&&(ae({rootEl:Q,name:"add",toEl:Q,fromEl:K,originalEvent:e}),ae({sortable:this,name:"remove",toEl:Q,originalEvent:e}),ae({rootEl:Q,name:"sort",toEl:Q,fromEl:K,originalEvent:e}),ae({sortable:this,name:"sort",toEl:Q,originalEvent:e})),oe&&oe.save()):fe!==je&&fe>=0&&(ae({sortable:this,name:"update",toEl:Q,originalEvent:e}),ae({sortable:this,name:"sort",toEl:Q,originalEvent:e})),N.active&&((fe==null||fe===-1)&&(fe=je,Oe=et),ae({sortable:this,name:"end",toEl:Q,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){ie("nulling",this),K=S=Q=$=xe=W=gt=Re=Me=ve=Xe=fe=Oe=je=et=ze=tt=oe=ut=N.dragged=N.ghost=N.clone=N.active=null,Tt.forEach(function(e){e.checked=!0}),Tt.length=$t=Mt=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":S&&(this._onDragOver(e),Wl(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],t,o=this.el.children,l=0,a=o.length,r=this.options;l<a;l++)t=o[l],ye(t,r.draggable,this.el,!1)&&e.push(t.getAttribute(r.dataIdAttr)||oa(t));return e},sort:function(e,t){var o={},l=this.el;this.toArray().forEach(function(a,r){var i=l.children[r];ye(i,this.options.draggable,l,!1)&&(o[a]=i)},this),t&&this.captureAnimationState(),e.forEach(function(a){o[a]&&(l.removeChild(o[a]),l.appendChild(o[a]))}),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return ye(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var o=this.options;if(t===void 0)return o[e];var l=it.modifyOption(this,e,t);typeof l<"u"?o[e]=l:o[e]=t,e==="group"&&Co(o)},destroy:function(){ie("destroy",this);var e=this.el;e[ue]=null,U(e,"mousedown",this._onTapStart),U(e,"touchstart",this._onTapStart),U(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(U(e,"dragover",this),U(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),St.splice(St.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Re){if(ie("hideClone",this),N.eventCanceled)return;P(W,"display","none"),this.options.removeCloneOnHide&&W.parentNode&&W.parentNode.removeChild(W),Re=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Re){if(ie("showClone",this),N.eventCanceled)return;S.parentNode==K&&!this.options.group.revertClone?K.insertBefore(W,S):xe?K.insertBefore(W,xe):K.appendChild(W),this.options.group.revertClone&&this.animate(S,W),P(W,"display",""),Re=!1}}};function Wl(n){n.dataTransfer&&(n.dataTransfer.dropEffect="move"),n.cancelable&&n.preventDefault()}function ft(n,e,t,o,l,a,r,i){var c,u=n[ue],m=u.options.onMove,g;return window.CustomEvent&&!Ae&&!rt?c=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(c=document.createEvent("Event"),c.initEvent("move",!0,!0)),c.to=e,c.from=n,c.dragged=t,c.draggedRect=o,c.related=l||e,c.relatedRect=a||te(e),c.willInsertAfter=i,c.originalEvent=r,n.dispatchEvent(c),m&&(g=m.call(u,c,r)),g}function xt(n){n.draggable=!1}function Ql(){Bt=!1}function Zl(n,e,t){var o=te(Ke(t.el,0,t.options,!0)),l=Do(t.el,t.options,$),a=10;return e?n.clientX<l.left-a||n.clientY<o.top&&n.clientX<o.right:n.clientY<l.top-a||n.clientY<o.bottom&&n.clientX<o.left}function Jl(n,e,t){var o=te(Kt(t.el,t.options.draggable)),l=Do(t.el,t.options,$),a=10;return e?n.clientX>l.right+a||n.clientY>o.bottom&&n.clientX>o.left:n.clientY>l.bottom+a||n.clientX>o.right&&n.clientY>o.top}function ea(n,e,t,o,l,a,r,i){var c=o?n.clientY:n.clientX,u=o?t.height:t.width,m=o?t.top:t.left,g=o?t.bottom:t.right,_=!1;if(!r){if(i&&bt<u*l){if(!ot&&(tt===1?c>m+u*a/2:c<g-u*a/2)&&(ot=!0),ot)_=!0;else if(tt===1?c<m+bt:c>g-bt)return-tt}else if(c>m+u*(1-l)/2&&c<g-u*(1-l)/2)return ta(e)}return _=_||r,_&&(c<m+u*a/2||c>g-u*a/2)?c>m+u/2?1:-1:0}function ta(n){return me(S)<me(n)?1:-1}function oa(n){for(var e=n.tagName+n.className+n.src+n.href+n.textContent,t=e.length,o=0;t--;)o+=e.charCodeAt(t);return o.toString(36)}function na(n){Tt.length=0;for(var e=n.getElementsByTagName("input"),t=e.length;t--;){var o=e[t];o.checked&&Tt.push(o)}}function vt(n){return setTimeout(n,0)}function jt(n){return clearTimeout(n)}At&&z(document,"touchmove",function(n){(N.active||Be)&&n.cancelable&&n.preventDefault()});N.utils={on:z,off:U,css:P,find:So,is:function(e,t){return!!ye(e,t,e,!1)},extend:Ll,throttle:To,closest:ye,toggleClass:de,clone:Eo,index:me,nextTick:vt,cancelNextTick:jt,detectDirection:Vo,getChild:Ke,expando:ue};N.get=function(n){return n[ue]};N.mount=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];e[0].constructor===Array&&(e=e[0]),e.forEach(function(o){if(!o.prototype||!o.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(o));o.utils&&(N.utils=De(De({},N.utils),o.utils)),it.mount(o)})};N.create=function(n,e){return new N(n,e)};N.version=Fl;var ee=[],We,Ht,Gt=!1,Lt,Yt,kt,Qe;function la(){function n(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return n.prototype={dragStarted:function(t){var o=t.originalEvent;this.sortable.nativeDraggable?z(document,"dragover",this._handleAutoScroll):this.options.supportPointer?z(document,"pointermove",this._handleFallbackAutoScroll):o.touches?z(document,"touchmove",this._handleFallbackAutoScroll):z(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var o=t.originalEvent;!this.options.dragOverBubble&&!o.rootEl&&this._handleAutoScroll(o)},drop:function(){this.sortable.nativeDraggable?U(document,"dragover",this._handleAutoScroll):(U(document,"pointermove",this._handleFallbackAutoScroll),U(document,"touchmove",this._handleFallbackAutoScroll),U(document,"mousemove",this._handleFallbackAutoScroll)),uo(),yt(),Yl()},nulling:function(){kt=Ht=We=Gt=Qe=Lt=Yt=null,ee.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,o){var l=this,a=(t.touches?t.touches[0]:t).clientX,r=(t.touches?t.touches[0]:t).clientY,i=document.elementFromPoint(a,r);if(kt=t,o||this.options.forceAutoScrollFallback||rt||Ae||Ze){Ut(t,this.options,i,o);var c=Ne(i,!0);Gt&&(!Qe||a!==Lt||r!==Yt)&&(Qe&&uo(),Qe=setInterval(function(){var u=Ne(document.elementFromPoint(a,r),!0);u!==c&&(c=u,yt()),Ut(t,l.options,u,o)},10),Lt=a,Yt=r)}else{if(!this.options.bubbleScroll||Ne(i,!0)===Ee()){yt();return}Ut(t,this.options,Ne(i,!1),!1)}}},Ce(n,{pluginName:"scroll",initializeByDefault:!0})}function yt(){ee.forEach(function(n){clearInterval(n.pid)}),ee=[]}function uo(){clearInterval(Qe)}var Ut=To(function(n,e,t,o){if(e.scroll){var l=(n.touches?n.touches[0]:n).clientX,a=(n.touches?n.touches[0]:n).clientY,r=e.scrollSensitivity,i=e.scrollSpeed,c=Ee(),u=!1,m;Ht!==t&&(Ht=t,yt(),We=e.scroll,m=e.scrollFn,We===!0&&(We=Ne(t,!0)));var g=0,_=We;do{var y=_,d=te(y),s=d.top,E=d.bottom,F=d.left,R=d.right,x=d.width,L=d.height,I=void 0,w=void 0,f=y.scrollWidth,b=y.scrollHeight,C=P(y),v=y.scrollLeft,O=y.scrollTop;y===c?(I=x<f&&(C.overflowX==="auto"||C.overflowX==="scroll"||C.overflowX==="visible"),w=L<b&&(C.overflowY==="auto"||C.overflowY==="scroll"||C.overflowY==="visible")):(I=x<f&&(C.overflowX==="auto"||C.overflowX==="scroll"),w=L<b&&(C.overflowY==="auto"||C.overflowY==="scroll"));var Y=I&&(Math.abs(R-l)<=r&&v+x<f)-(Math.abs(F-l)<=r&&!!v),G=w&&(Math.abs(E-a)<=r&&O+L<b)-(Math.abs(s-a)<=r&&!!O);if(!ee[g])for(var H=0;H<=g;H++)ee[H]||(ee[H]={});(ee[g].vx!=Y||ee[g].vy!=G||ee[g].el!==y)&&(ee[g].el=y,ee[g].vx=Y,ee[g].vy=G,clearInterval(ee[g].pid),(Y!=0||G!=0)&&(u=!0,ee[g].pid=setInterval((function(){o&&this.layer===0&&N.active._onTouchMove(kt);var Te=ee[this.layer].vy?ee[this.layer].vy*i:0,pe=ee[this.layer].vx?ee[this.layer].vx*i:0;typeof m=="function"&&m.call(N.dragged.parentNode[ue],pe,Te,n,kt,ee[this.layer].el)!=="continue"||ko(ee[this.layer].el,pe,Te)}).bind({layer:g}),24))),g++}while(e.bubbleScroll&&_!==c&&(_=Ne(_,!1)));Gt=u}},30),Ro=function(e){var t=e.originalEvent,o=e.putSortable,l=e.dragEl,a=e.activeSortable,r=e.dispatchSortableEvent,i=e.hideGhostForTarget,c=e.unhideGhostForTarget;if(t){var u=o||a;i();var m=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,g=document.elementFromPoint(m.clientX,m.clientY);c(),u&&!u.el.contains(g)&&(r("spill"),this.onSpill({dragEl:l,putSortable:o}))}};function Xt(){}Xt.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,o=e.putSortable;this.sortable.captureAnimationState(),o&&o.captureAnimationState();var l=Ke(this.sortable.el,this.startIndex,this.options);l?this.sortable.el.insertBefore(t,l):this.sortable.el.appendChild(t),this.sortable.animateAll(),o&&o.animateAll()},drop:Ro};Ce(Xt,{pluginName:"revertOnSpill"});function Wt(){}Wt.prototype={onSpill:function(e){var t=e.dragEl,o=e.putSortable,l=o||this.sortable;l.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),l.animateAll()},drop:Ro};Ce(Wt,{pluginName:"removeOnSpill"});N.mount(new la);N.mount(Wt,Xt);class aa{constructor(e,t,o={},l={},a={}){J(this,"api");J(this,"table",ke({ref:void 0,pk:"id",data:[],remark:null,loading:!1,selection:[],column:[],total:0,filter:{},dragSortLimitField:"pid",acceptQuery:!0,showComSearch:!1,dblClickNotEditColumn:[void 0],expandAll:!1,extend:{}}));J(this,"form",ke({ref:void 0,labelWidth:160,operate:"",operateIds:[],items:{},submitLoading:!1,defaultItems:{},loading:!1,extend:{}}));J(this,"before");J(this,"after");J(this,"comSearch",ke({form:{},fieldData:new Map}));J(this,"getIndex",()=>{if(this.runBefore("getIndex")!==!1)return this.table.loading=!0,this.api.index(this.table.filter).then(e=>{this.table.data=e.data.list,this.table.total=e.data.total,this.table.remark=e.data.remark,this.runAfter("getIndex",{res:e})}).finally(()=>{this.table.loading=!1})});J(this,"postDel",e=>{this.runBefore("postDel",{ids:e})!==!1&&this.api.del(e).then(t=>{this.onTableHeaderAction("refresh",{}),this.runAfter("postDel",{res:t})})});J(this,"requestEdit",e=>{if(this.runBefore("requestEdit",{id:e})!==!1)return this.form.loading=!0,this.form.items={},this.api.edit({[this.table.pk]:e}).then(t=>{this.form.items=t.data.row,this.runAfter("requestEdit",{res:t})}).catch(t=>{this.toggleForm(),this.runAfter("requestEdit",{err:t})}).finally(()=>{this.form.loading=!1})});J(this,"onTableDblclick",(e,t)=>{if(!this.table.dblClickNotEditColumn.includes("all")&&!this.table.dblClickNotEditColumn.includes(t.property)){if(this.runBefore("onTableDblclick",{row:e,column:t})===!1)return;this.toggleForm("Edit",[e[this.table.pk]]),this.runAfter("onTableDblclick",{row:e,column:t})}});J(this,"toggleForm",(e="",t=[])=>{if(this.runBefore("toggleForm",{operate:e,operateIds:t})!==!1){if(e=="Edit"){if(!t.length)return!1;this.requestEdit(t[0])}else e=="Add"&&(this.form.items=mo(this.form.defaultItems));this.form.operate=e,this.form.operateIds=t,this.runAfter("toggleForm",{operate:e,operateIds:t})}});J(this,"onSubmit",(e=void 0)=>{const t=this.form.operate.replace(this.form.operate[0],this.form.operate[0].toLowerCase());if(this.runBefore("onSubmit",{formEl:e,operate:t,items:this.form.items})===!1)return;const o=()=>{this.form.submitLoading=!0,this.api.postData(t,this.form.items).then(l=>{var a;this.onTableHeaderAction("refresh",{}),(a=this.form.operateIds)==null||a.shift(),this.form.operateIds.length>0?this.toggleForm("Edit",this.form.operateIds):this.toggleForm(),this.runAfter("onSubmit",{res:l})}).finally(()=>{this.form.submitLoading=!1})};e?(this.form.ref=e,e.validate(l=>{l&&o()})):o()});J(this,"onTableAction",(e,t)=>{if(this.runBefore("onTableAction",{event:e,data:t})===!1)return;const o=new Map([["selection-change",()=>{this.table.selection=t}],["page-size-change",()=>{this.table.filter.limit=t.size,this.onTableHeaderAction("refresh",{event:"page-size-change",...t})}],["current-page-change",()=>{this.table.filter.page=t.page,this.onTableHeaderAction("refresh",{event:"current-page-change",...t})}],["sort-change",()=>{let a;t.prop&&t.order&&(a=t.prop+","+t.order),a!=this.table.filter.order&&(this.table.filter.order=a,this.onTableHeaderAction("refresh",{event:"sort-change",...t}))}],["edit",()=>{this.toggleForm("Edit",[t.row[this.table.pk]])}],["delete",()=>{this.postDel([t.row[this.table.pk]])}],["field-change",()=>{}],["com-search",()=>{this.table.filter.search=this.getComSearchData(),this.onTableHeaderAction("refresh",{event:"com-search",data:this.table.filter.search})}],["default",()=>{console.warn("No action defined")}]]);return(o.get(e)||o.get("default")).call(this),this.runAfter("onTableAction",{event:e,data:t})});J(this,"onTableHeaderAction",(e,t)=>{if(this.runBefore("onTableHeaderAction",{event:e,data:t})===!1)return;const o=new Map([["refresh",()=>{this.table.data=[],this.getIndex()}],["add",()=>{this.toggleForm("Add")}],["edit",()=>{this.toggleForm("Edit",this.getSelectionIds())}],["delete",()=>{this.postDel(this.getSelectionIds())}],["unfold",()=>{if(!this.table.ref){console.warn("Collapse/expand failed because table ref is not defined. Please assign table ref when onMounted");return}this.table.expandAll=t.unfold,this.table.ref.unFoldAll(t.unfold)}],["quick-search",()=>{this.onTableHeaderAction("refresh",{event:"quick-search",...t})}],["change-show-column",()=>{const a=Ge(this.table.column,"prop",t.field);this.table.column[a].show=t.value}],["default",()=>{console.warn("No action defined")}]]);return(o.get(e)||o.get("default")).call(this),this.runAfter("onTableHeaderAction",{event:e,data:t})});J(this,"initSort",()=>{var e;if(this.table.defaultOrder&&this.table.defaultOrder.prop){if(!this.table.ref){console.warn("Failed to initialize default sorting because table ref is not defined. Please assign table ref when onMounted");return}const t=this.table.defaultOrder.prop+","+this.table.defaultOrder.order;this.table.filter&&this.table.filter.order!=t&&(this.table.filter.order=t,(e=this.table.ref.getRef())==null||e.sort(this.table.defaultOrder.prop,this.table.defaultOrder.order=="desc"?"descending":"ascending"))}});J(this,"dragSort",()=>{var a;const e=Ge(this.table.column,"render","buttons");if(e===!1)return;const t=Ge((a=this.table.column[e])==null?void 0:a.buttons,"render","moveButton");if(t===!1)return;if(!this.table.ref){console.warn("Failed to initialize drag sort because table ref is not defined. Please assign table ref when onMounted");return}const o=this.table.ref.getRef().$el.querySelector(".el-table__body-wrapper .el-table__body tbody"),l=this.table.column[e].buttons[t].disabledTip;N.create(o,{animation:200,handle:".table-row-weigh-sort",ghostClass:"ba-table-row",onStart:()=>{this.table.column[e].buttons[t].disabledTip=!0},onEnd:r=>{var u;if(this.table.column[e].buttons[t].disabledTip=l,r.oldIndex==r.newIndex||typeof r.newIndex>"u"||typeof r.oldIndex>"u")return;const i=zt(this.table.data,r.oldIndex),c=zt(this.table.data,r.newIndex);if(this.table.dragSortLimitField&&i[this.table.dragSortLimitField]!=c[this.table.dragSortLimitField]){this.onTableHeaderAction("refresh",{}),Qo({type:"error",message:pt.global.t("utils.The moving position is beyond the movable range!")});return}this.api.sortable({move:i[this.table.pk],target:c[this.table.pk],order:(u=this.table.filter)==null?void 0:u.order,direction:r.newIndex>r.oldIndex?"down":"up"}).finally(()=>{this.onTableHeaderAction("refresh",{})})}})});J(this,"mount",()=>{var t;if(this.runBefore("mount")===!1)return;const e=Zo();this.table.routePath=e.fullPath,this.initComSearch(),this.table.acceptQuery&&!we(e.query)&&(this.setComSearchData(e.query),this.table.filter.search=this.getComSearchData().concat(((t=this.table.filter)==null?void 0:t.search)??[]))});J(this,"initComSearch",()=>{const e={},t=this.table.column;if(!(t.length<=0)){for(const o in t){if(t[o].operator===!1)continue;typeof t[o].operator>"u"&&(t[o].operator="eq");const l=t[o].prop;l&&(t[o].operator=="RANGE"||t[o].operator=="NOT RANGE"?(e[l]="",e[l+"-start"]="",e[l+"-end"]=""):t[o].operator=="NULL"||t[o].operator=="NOT NULL"?e[l]=!1:e[l]="",this.comSearch.fieldData.set(l,{operator:t[o].operator,render:t[o].render,comSearchRender:t[o].comSearchRender}))}this.comSearch.form=Object.assign(this.comSearch.form,e)}});J(this,"setComSearchData",e=>{for(const t in this.table.column){const o=this.table.column[t].prop;if(o&&typeof e[o]<"u"){const l=e[o]??"";if(this.table.column[t].operator=="RANGE"||this.table.column[t].operator=="NOT RANGE"){const a=l.split(",");if(this.table.column[t].render=="datetime"||this.table.column[t].comSearchRender=="date"){if(a&&a.length>=2){const r=[Rt(a[0]),Rt(a[1])];r[0].isValid()&&r[1].isValid()&&(this.table.column[t].comSearchRender=="date"?this.comSearch.form[o]=[r[0].format("YYYY-MM-DD"),r[1].format("YYYY-MM-DD")]:this.comSearch.form[o]=[r[0].format("YYYY-MM-DD HH:mm:ss"),r[1].format("YYYY-MM-DD HH:mm:ss")])}}else this.comSearch.form[o+"-start"]=a[0]??"",this.comSearch.form[o+"-end"]=a[1]??""}else if(this.table.column[t].operator=="NULL"||this.table.column[t].operator=="NOT NULL")this.comSearch.form[o]=!!l;else if(this.table.column[t].render=="datetime"||this.table.column[t].comSearchRender=="date"){const a=Rt(l);a.isValid()&&(this.comSearch.form[o]=a.format(this.table.column[t].comSearchRender=="date"?"YYYY-MM-DD":"YYYY-MM-DD HH:mm:ss"))}else this.comSearch.form[o]=l}}});J(this,"getComSearchData",()=>{const e=[];for(const t in this.comSearch.form){if(!this.comSearch.fieldData.has(t))continue;let o=null;const l=this.comSearch.fieldData.get(t);if(l.render=="datetime"&&(l.operator=="RANGE"||l.operator=="NOT RANGE"))this.comSearch.form[t]&&this.comSearch.form[t].length>=2&&(l.comSearchRender=="date"?o=this.comSearch.form[t][0]+" 00:00:00,"+this.comSearch.form[t][1]+" 23:59:59":o=this.comSearch.form[t][0]+","+this.comSearch.form[t][1]);else if(l.operator=="RANGE"||l.operator=="NOT RANGE"){if(!this.comSearch.form[t+"-start"]&&!this.comSearch.form[t+"-end"])continue;o=this.comSearch.form[t+"-start"]+","+this.comSearch.form[t+"-end"]}else this.comSearch.form[t]&&(o=this.comSearch.form[t]);o!==null&&(Vt(o)&&!o.length||e.push({field:t,val:o,operator:l.operator,render:l.render}))}return e});this.api=e,this.form=Object.assign(this.form,o),this.table=Object.assign(this.table,t),this.before=l,this.after=a}auth(e){return Uo(e)}runBefore(e,t={}){return this.before&&this.before[e]&&typeof this.before[e]=="function"?this.before[e]({...t})!==!1:!0}runAfter(e,t={}){return this.after&&this.after[e]&&typeof this.after[e]=="function"?this.after[e]({...t})!==!1:!0}getSelectionIds(){var t;const e=[];return(t=this.table.selection)==null||t.forEach(o=>{e.push(o[this.table.pk])}),e}}const ra={class:"table-header-operate-text"},ia={key:0,class:"ml-10"},sa={class:"selection-count"},ua=Z({__name:"selectFile",props:{type:{default:"file"},limit:{default:0},modelValue:{type:Boolean,default:!1},returnFullUrl:{type:Boolean,default:!1}},emits:["update:modelValue","choice"],setup(n,{emit:e}){const t=n,o=e,l=Pe(),{t:a}=Et.useI18n(),r=ke({ready:!1,tableSelectable:!0}),i=[{render:"tipButton",name:"choice",text:a("utils.choice"),type:"primary",icon:"fa fa-check",class:"table-row-choice",disabledTip:!1,click:_=>{l.value.getRef().clearSelection(),o("choice",t.returnFullUrl?[_.full_url]:[_.url])}}],c=new aa(new zo("/admin/routine.Attachment/"),{acceptQuery:!1,column:[{type:"selection",selectable:_=>{if(t.limit==0)return!0;if(c.table.selection){for(const y in c.table.selection)if(_.id==c.table.selection[y].id)return!0}return r.tableSelectable},align:"center",operator:!1},{label:a("Id"),prop:"id",align:"center",operator:"LIKE",operatorPlaceholder:a("Fuzzy query"),width:70},{label:a("utils.Breakdown"),prop:"topic",align:"center",operator:"LIKE",operatorPlaceholder:a("Fuzzy query")},{label:a("utils.preview"),prop:"suffix",align:"center",formatter:ln,render:"image",operator:!1},{label:a("utils.type"),prop:"mimetype",align:"center",operator:"LIKE",showOverflowTooltip:!0,operatorPlaceholder:a("Fuzzy query")},{label:a("utils.size"),prop:"size",align:"center",formatter:(_,y,d)=>{var s=parseFloat(d),E=Math.floor(Math.log(s)/Math.log(1024));return parseInt((s/Math.pow(1024,E)).toFixed(E<2?0:2))*1+" "+["B","KB","MB","GB","TB"][E]},operator:"RANGE",sortable:"custom",operatorPlaceholder:"bytes"},{label:a("utils.Last upload time"),prop:"last_upload_time",align:"center",render:"datetime",operator:"RANGE",width:160,sortable:"custom"},{show:!1,label:a("utils.Upload (Reference) times"),prop:"quote",align:"center",width:150,operator:"RANGE",sortable:"custom"},{label:a("utils.Original name"),prop:"name",align:"center",showOverflowTooltip:!0,operator:"LIKE",operatorPlaceholder:a("Fuzzy query")},{label:a("Operate"),align:"center",width:"100",render:"buttons",buttons:i,operator:!1}],defaultOrder:{prop:"last_upload_time",order:"desc"}});Jo("baTable",c);const u=()=>{var _;t.type=="image"&&(c.table.filter.search=[{field:"mimetype",val:"image",operator:"LIKE"}]),c.table.ref=l.value,c.table.filter.limit=8,(_=c.getIndex())==null||_.then(()=>{c.initSort()}),r.ready=!0},m=()=>{var _;if((_=c.table.selection)!=null&&_.length){let y=[];for(const s in c.table.selection)y.push(t.returnFullUrl?c.table.selection[s].full_url:c.table.selection[s].url);o("choice",y),l.value.getRef().clearSelection()}},g=_=>{t.limit!=0&&(_.length>t.limit&&l.value.getRef().toggleRowSelection(_[_.length-1],!1),r.tableSelectable=!(_.length>=t.limit))};return Dt(()=>{c.mount()}),lt(()=>t.modelValue,_=>{_&&!r.ready&&Le(()=>{u()})}),(_,y)=>{const d=D("Icon"),s=D("el-button"),E=D("el-tooltip"),F=D("el-dialog"),R=Ye("blur");return p(),V("div",null,[k(F,{onClose:y[0]||(y[0]=x=>o("update:modelValue",!1)),width:"60%","model-value":_.modelValue,class:"ba-upload-select-dialog",title:h(a)("utils.Select File"),"append-to-body":!0,"destroy-on-close":!0,top:"4vh"},{default:T(()=>[k(Nl,{buttons:["refresh","comSearch","quickSearch","columnDisplay"],"quick-search-placeholder":h(a)("Quick search placeholder",{fields:h(a)("utils.Original name")})},{default:T(()=>[k(E,{content:h(a)("utils.choice"),placement:"top"},{default:T(()=>[ne((p(),A(s,{onClick:m,disabled:!(h(c).table.selection.length>0),class:"table-header-operate",type:"primary"},{default:T(()=>[k(d,{name:"fa fa-check"}),B("span",ra,j(h(a)("utils.choice")),1)]),_:1},8,["disabled"])),[[R]])]),_:1},8,["content"]),_.limit!==0?(p(),V("div",ia,[_e(j(h(a)("utils.You can also select"))+" ",1),B("span",sa,j(_.limit-h(c).table.selection.length),1),_e(" "+j(h(a)("utils.items")),1)])):M("",!0)]),_:1},8,["quick-search-placeholder"]),k(dl,{ref_key:"tableRef",ref:l,onSelectionChange:g},null,512)]),_:1},8,["model-value","title"])])}}}),ca={class:"w100"},da={class:"ml-6"},fa={class:"ba-upload-preview-scroll ba-scroll-style"},pa=["src"],ha=Z({inheritAttrs:!1,__name:"baUpload",props:{type:{default:"image"},data:{default:()=>({})},modelValue:{default:()=>[]},returnFullUrl:{type:Boolean,default:!1},hideSelectFile:{type:Boolean,default:!1},attr:{default:()=>({})},forceLocal:{type:Boolean,default:!1},hideImagePlusOnOverLimit:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{expose:e,emit:t}){const o=n,l=t,a=go(),r=Pe(),i=ke({key:Ot(),defaultReturnType:"string",preview:{show:!1,url:""},fileList:[],attrs:{},uploading:0,selectFile:{show:!1,type:"file",returnFullUrl:o.returnFullUrl},events:{}}),c={change:["onChange","on-change"],remove:["onRemove","on-remove"],preview:["onPreview","on-preview"],exceed:["onExceed","on-exceed"],beforeUpload:["beforeUpload","onBeforeUpload","before-upload","on-before-upload"],progress:["onProgress","on-progress"],success:["onSuccess","on-success"],error:["onError","on-error"]},u=(f,b)=>{const C=Ge(b,"uid",f.uid);if(C===!1||(f=b[C],!f||!f.raw)||s("beforeUpload",[f])===!1)return;let v=new FormData;v.append("file",f.raw),v=x(v),f.status="uploading",i.uploading++,jo(v,{uuid:Ot()},o.forceLocal,{onUploadProgress:O=>{const Y=O;O.total&&O.total>0&&["ready","uploading"].includes(f.status)&&(Y.percent=O.loaded/O.total*100,f.status="uploading",f.percentage=Math.round(Y.percent),s("progress",[Y,f,b]))}}).then(O=>{O.code==1?(f.serverUrl=O.data.file.url,f.status="success",l("update:modelValue",R()),s("success",[O,f,b])):(f.status="fail",b.splice(C,1),s("error",[O,f,b]))}).catch(O=>{f.status="fail",b.splice(C,1),s("error",[O,f,b])}).finally(()=>{i.uploading--,L(f,b)})},m=(f,b)=>{s("remove",[f,b]),L(f,b),Le(()=>{l("update:modelValue",R())})},g=f=>{if(s("preview",[f]),!(!f||!f.serverUrl)){if(o.type=="file"||o.type=="files"){window.open(He(f.serverUrl));return}i.preview.show=!0,i.preview.url=He(f.serverUrl)}},_=f=>{const b=f[0];b.uid=en(),r.value.handleStart(b),s("exceed",[b,i.fileList])},y=f=>{f=R("array").concat(f),F(f),l("update:modelValue",R()),L(f,i.fileList),i.selectFile.show=!1},d=()=>{Le(()=>{var C;let f=(C=r.value)==null?void 0:C.$el.querySelector(".el-upload-list");f.getElementsByClassName("el-upload-list__item").length>=2&&N.create(f,{animation:200,draggable:".el-upload-list__item",onEnd:v=>{v.oldIndex!=v.newIndex&&(i.fileList[v.newIndex]=[i.fileList[v.oldIndex],i.fileList[v.oldIndex]=i.fileList[v.newIndex]][0],l("update:modelValue",R()))}})})},s=(f,b)=>{const C=c[f];if(C){for(const v in C)if(typeof i.events[C[v]]=="function"&&i.events[C[v]](...b)===!1)return!1}};Dt(()=>{const f={};if(!we(o.attr)){const v=["onPreview","onRemove","onSuccess","onError","onChange","onExceed","beforeUpload","onProgress"];for(const O in o.attr)v.includes(O)?i.events[O]=o.attr[O]:f[O]=o.attr[O];console.warn("图片/文件上传组件的 props.attr 已经弃用，并将于 v2.2.0 版本彻底删除，请将 props.attr 的部分直接作为 props 传递！")}let b=[],C={};for(const v in c)b=[...b,...c[v]];for(const v in a)b.includes(v)?i.events[v]=a[v]:C[v]=a[v];o.type=="image"||o.type=="file"?C={...C,limit:1}:C={...C,multiple:!0},(o.type=="image"||o.type=="images")&&(i.selectFile.type="image",C={...C,accept:"image/*",listType:"picture-card"}),i.attrs={...C,...f},i.attrs.limit&&(i.selectFile.limit=i.attrs.limit),F(o.modelValue),d()});const E=()=>i.attrs.limit&&i.fileList.length>i.attrs.limit?(i.fileList=i.fileList.slice(i.fileList.length-i.attrs.limit),!0):!1,F=f=>{let b=eo(f);i.fileList=[],i.defaultReturnType=typeof f=="string"||o.type=="file"||o.type=="image"?"string":"array";for(const C in b)i.fileList.push({name:Bo(b[C]),url:He(b[C]),serverUrl:b[C]});(E()||o.returnFullUrl)&&l("update:modelValue",R()),i.key=Ot()},R=(f=i.defaultReturnType)=>{E();let b=[];for(const C in i.fileList)i.fileList[C].serverUrl&&b.push(i.fileList[C].serverUrl);return o.returnFullUrl&&(b=ht(b)),f==="string"?b.join(","):b},x=f=>{if(o.data&&!we(o.data))for(const b in o.data)f.append(b,o.data[b]);return f},L=(f,b)=>{d(),s("change",[f,b])},I=()=>r.value,w=()=>{i.attrs.disabled||(i.selectFile.show=!0)};return e({getRef:I,showSelectFile:w}),lt(()=>o.modelValue,f=>{if(i.uploading>0)return;if(f==null)return F("");let b=ht(eo(mo(f))),C=ht(R("array"));b.sort().toString()!=C.sort().toString()&&F(f)}),(f,b)=>{const C=D("Icon"),v=D("el-button"),O=D("el-upload"),Y=D("el-dialog"),G=Ye("blur");return p(),V("div",ca,[(p(),A(O,ge({ref_key:"upload",ref:r,class:["ba-upload",[f.type,i.attrs.disabled?"is-disabled":"",f.hideImagePlusOnOverLimit&&i.attrs.limit&&i.fileList.length>=i.attrs.limit?"hide-image-plus":""]],"file-list":i.fileList,"onUpdate:fileList":b[2]||(b[2]=H=>i.fileList=H),"auto-upload":!1,onChange:u,onRemove:m,onPreview:g,onExceed:_},i.attrs,{key:i.key}),Ct({_:2},[f.$slots.default?void 0:{name:"default",fn:T(()=>[f.type=="image"||f.type=="images"?(p(),V(X,{key:0},[f.hideSelectFile?M("",!0):(p(),V("div",{key:0,onClick:b[0]||(b[0]=nt(H=>w(),["stop"])),class:"ba-upload-select-image"},j(f.$t("utils.choice")),1)),k(C,{class:"ba-upload-icon",name:"el-icon-Plus",size:"30",color:"#c0c4cc"})],64)):(p(),V(X,{key:1},[ne((p(),A(v,{type:"primary"},{default:T(()=>[k(C,{name:"el-icon-Plus",color:"#ffffff"}),B("span",null,j(f.$t("Upload")),1)]),_:1})),[[G]]),f.hideSelectFile?M("",!0):ne((p(),A(v,{key:0,onClick:b[1]||(b[1]=nt(H=>w(),["stop"])),type:"success"},{default:T(()=>[k(C,{name:"fa fa-th-list",size:"14px",color:"#ffffff"}),B("span",da,j(f.$t("utils.choice")),1)]),_:1})),[[G]])],64))]),key:"0"},ce(f.$slots,(H,Te)=>({name:Te,fn:T(pe=>[be(f.$slots,Te,bo(vo(pe)),void 0,!0)])}))]),1040,["class","file-list"])),k(Y,{modelValue:i.preview.show,"onUpdate:modelValue":b[3]||(b[3]=H=>i.preview.show=H),class:"ba-upload-preview"},{default:T(()=>[B("div",fa,[B("img",{src:i.preview.url,class:"ba-upload-preview-img",alt:""},null,8,pa)])]),_:1},8,["modelValue"]),k(ua,ge({modelValue:i.selectFile.show,"onUpdate:modelValue":b[4]||(b[4]=H=>i.selectFile.show=H)},i.selectFile,{onChoice:y}),null,16,["modelValue"])])}}}),ma=re(ha,[["__scopeId","data-v-23617c2d"]]),ga={},ba={class:"tips"};function va(n,e){return p(),V("div",ba,j(n.$t("utils.Please install editor")),1)}const ya=re(ga,[["render",va],["__scopeId","data-v-5d5c399b"]]),_a=Object.freeze(Object.defineProperty({__proto__:null,default:ya},Symbol.toStringTag,{value:"Module"})),wa=Z({__name:"editor",props:{editorType:{default:"default"}},setup(n){const e=n,t=ke({editorType:e.editorType}),o={},l=Object.assign({"../../mixins/editor/default.vue":_a});for(const a in l){const r=a.replace("../../mixins/editor/","").replace(".vue","");o[r]=l[a].default,e.editorType=="default"&&r!="default"&&(t.editorType=r)}return(a,r)=>(p(),V("div",null,[(p(),A(It(o[t.editorType]),bo(vo(a.$attrs)),null,16))]))}}),Sa={class:"w100"},Ta=Z({__name:"remoteSelect",props:{pk:{default:"id"},field:{default:"name"},params:{default:()=>({})},remoteUrl:{default:""},modelValue:{default:""},pagination:{type:Boolean,default:!0},tooltipParams:{default:()=>({})},paginationLayout:{default:"total, ->, prev, pager, next"},labelFormatter:{},escBlur:{type:Boolean,default:!0}},emits:["update:modelValue","row"],setup(n,{expose:e,emit:t}){const o=go(),l=co(),a=Pe(),r=n,i=se(()=>{let v=o.valueOnClear;return v===void 0&&(v=o.multiple?()=>[]:()=>null),typeof v=="function"?v():v}),c=se(()=>o.emptyValues||[null,void 0,""]),u=ke({primaryKey:r.pk,options:[],loading:!1,total:0,currentPage:1,pageSize:10,params:r.params,keyword:"",value:i.value,initializeFlag:!1,optionValidityFlag:!1,focusStatus:!1});let m=null;const g=on(),_=t,y=v=>{var O;if(v=I(v),typeof((O=g==null?void 0:g.vnode.props)==null?void 0:O.onRow)=="function")if(typeof v=="number"||typeof v=="string"){const Y=Ge(u.options,u.primaryKey,""+v);_("row",Y!==!1?Jt(u.options[Y]):{})}else{const Y=[];for(const G in v){const H=Ge(u.options,u.primaryKey,""+v[G]);H!==!1&&Y.push(Jt(u.options[H]))}_("row",Y)}},d=v=>{var O;r.escBlur&&(v.stopPropagation(),(O=a.value)==null||O.blur())},s=()=>{u.focusStatus=!0,u.optionValidityFlag||x()},E=()=>{Le(()=>{var v,O;(v=a.value)==null||v.blur(),(O=a.value)==null||O.focus()})},F=()=>{u.keyword="",u.focusStatus=!1},R=v=>{u.keyword!=v&&(u.keyword=v,u.currentPage=1,x())},x=ho((v="")=>{u.loading=!0,u.params.page=u.currentPage,u.params.initKey=r.pk,u.params.initValue=v,Ho(r.remoteUrl,u.keyword,u.params).then(O=>{let Y=O.data.options?O.data.options:O.data.list;if(typeof r.labelFormatter=="function")for(const G in Y)Y[G][r.field]=r.labelFormatter(Y[G],G);u.options=Y,u.total=O.data.total??0,u.optionValidityFlag=!(u.keyword||(typeof v=="object"?!we(v):v))}).finally(()=>{u.loading=!1,u.initializeFlag=!0})},100),L=v=>{u.currentPage=v,x()},I=v=>{if(c.value.includes(v))u.value=i.value;else if(u.value=v,typeof u.value=="object")for(const O in u.value)u.value[O]=""+u.value[O];else typeof u.value=="number"&&(u.value=""+u.value);return _("update:modelValue",u.value),u.value};Dt(()=>{u.params.uuid=fo();let v=r.pk.split(".");u.primaryKey=v[v.length-1],I(r.modelValue),x(u.value),setTimeout(()=>{var O;window!=null&&window.IntersectionObserver&&(m=new IntersectionObserver(Y=>{var G;for(const H in Y)Y[H].isIntersecting||(G=a.value)==null||G.blur()}),((O=a.value)==null?void 0:O.$el)instanceof Element&&m.observe(a.value.$el))},500)}),tn(()=>{m==null||m.disconnect()}),lt(()=>r.modelValue,v=>{w(u.value)!=w(v)&&(I(v),x(u.value))});const w=v=>`${typeof v}:${String(v)}`;return e({blur:()=>{var v;(v=a.value)==null||v.blur()},focus:()=>{var v;(v=a.value)==null||v.focus()},getRef:()=>a.value}),(v,O)=>{const Y=D("el-tooltip"),G=D("el-option"),H=D("el-pagination"),Te=D("el-select"),pe=D("el-popover");return p(),V("div",Sa,[k(pe,{width:"100%",placement:"bottom","popper-class":"remote-select-popper",visible:u.focusStatus&&!u.loading&&!u.keyword&&!u.options.length,teleported:!1,content:v.$t("utils.No data"),"hide-after":0},{reference:T(()=>[k(Te,ge({ref_key:"selectRef",ref:a,class:"w100",remote:"",clearable:"",filterable:"","automatic-dropdown":"","remote-show-suffix":"",modelValue:u.value,"onUpdate:modelValue":O[0]||(O[0]=he=>u.value=he),loading:u.loading,disabled:r.disabled||!u.initializeFlag,onBlur:F,onFocus:s,onClear:E,onChange:y,onKeydownCapture:po(d,["esc"]),"remote-method":R},v.$attrs),Ct({default:T(()=>[(p(!0),V(X,null,ce(u.options,he=>(p(),A(G,{class:"remote-select-option",label:he[v.field],value:he[u.primaryKey].toString(),key:he[u.primaryKey]},{default:T(()=>[h(we)(v.tooltipParams)?M("",!0):(p(),A(Y,{key:0,placement:"right",effect:"light"},{content:T(()=>[(p(!0),V(X,null,ce(v.tooltipParams,($e,st)=>(p(),V("p",{key:st},j(st)+": "+j(he[$e]),1))),128))]),default:T(()=>[B("div",null,j(he[v.field]),1)]),_:2},1024))]),_:2},1032,["label","value"]))),128))]),_:2},[u.total&&r.pagination?{name:"footer",fn:T(()=>[k(H,{currentPage:u.currentPage,"page-size":u.pageSize,"pager-count":5,class:"select-pagination",layout:r.paginationLayout,total:u.total,onCurrentChange:L,small:h(l).layout.shrink},null,8,["currentPage","page-size","layout","total","small"])]),key:"0"}:void 0]),1040,["modelValue","loading","disabled"])]),_:1},8,["visible","content"])])}}}),ka=re(Ta,[["__scopeId","data-v-64a9d8aa"]]),Ea=Z({name:"baInput",props:{type:{type:String,required:!0,validator:n=>wn.includes(n)},modelValue:{type:null,required:!0},attr:{type:Object,default:()=>{}},data:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(n,{emit:e,slots:t}){const o=se(()=>({...n.attr,...n.data})),l=y=>{e("update:modelValue",y)},a=()=>()=>k(D("el-input"),{type:n.type=="string"?"text":n.type,...o.value,modelValue:n.modelValue,"onUpdate:modelValue":l},t),r=()=>{o.value.content||console.warn("请传递 "+n.type+" 的 content");const y=se(()=>{const d=[],s=Vt(o.value.content),E=o.value.button?n.type+"-button":n.type;for(const F in o.value.content){let R={};s?(typeof o.value.content[F].value=="number"&&console.warn(n.type+" 的 content.value 不能是数字"),R={...o.value.content[F],border:o.value.border?o.value.border:!1,...o.value.childrenAttr||{}}):R={value:F,label:o.value.content[F],border:o.value.border?o.value.border:!1,...o.value.childrenAttr||{}},d.push(k(D("el-"+E),R,t))}return d});return()=>{const d=se(()=>{if(n.type=="radio")return n.modelValue==null?"":""+n.modelValue;{let s=[];for(const E in n.modelValue)s[E]=""+n.modelValue[E];return s}});return k(D("el-"+n.type+"-group"),{...o.value,modelValue:d.value,"onUpdate:modelValue":l},()=>y.value)}},i=()=>{o.value.content||console.warn("请传递 "+n.type+"的 content");const y=se(()=>{const d=[];for(const s in o.value.content)d.push(k(D("el-option"),{key:s,label:o.value.content[s],value:s,...o.value.childrenAttr||{}},t));return d});return()=>{const d=se(()=>{if(n.type=="select")return n.modelValue==null?"":""+n.modelValue;{let s=[];for(const E in n.modelValue)s[E]=""+n.modelValue[E];return s}});return k(D("el-select"),{class:"w100",multiple:n.type!="select",clearable:!0,...o.value,modelValue:d.value,"onUpdate:modelValue":l},()=>y.value)}},c=()=>{let y="YYYY-MM-DD HH:mm:ss";switch(n.type){case"date":y="YYYY-MM-DD";break;case"year":y="YYYY";break}return()=>k(D("el-date-picker"),{class:"w100",type:n.type,"value-format":y,...o.value,modelValue:n.modelValue,"onUpdate:modelValue":l},t)},u=()=>()=>k(ma,{type:n.type,modelValue:n.modelValue,"onUpdate:modelValue":l,...o.value},t),m=()=>()=>k(ka,{modelValue:n.modelValue,"onUpdate:modelValue":l,multiple:n.type!="remoteSelect",...o.value},t),g=new Map([["string",a],["number",()=>()=>k(D("el-input-number"),{class:"w100","controls-position":"right",...o.value,modelValue:nn(n.modelValue)?Number(n.modelValue):n.modelValue,"onUpdate:modelValue":l},t)],["textarea",a],["password",a],["radio",r],["checkbox",r],["switch",()=>{const y=se(()=>typeof o.value.activeValue<"u"&&typeof o.value.inactiveValue<"u"?"custom":typeof n.modelValue),d=se(()=>{if(y.value==="boolean"||y.value==="custom")return n.modelValue;{let s=parseInt(n.modelValue);return!(isNaN(s)||s<=0)}});return()=>k(D("el-switch"),{...o.value,modelValue:d.value,"onUpdate:modelValue":s=>{let E=s;switch(y.value){case"string":E=s?"1":"0";break;case"number":E=s?1:0}e("update:modelValue",E)}},t)}],["datetime",c],["year",()=>()=>{const y=se(()=>n.modelValue?""+n.modelValue:null);return k(D("el-date-picker"),{class:"w100",type:n.type,"value-format":"YYYY",...o.value,modelValue:y.value,"onUpdate:modelValue":l},t)}],["date",c],["time",()=>()=>k(D("el-time-picker"),{class:"w100",clearable:!0,format:"HH:mm:ss",valueFormat:"HH:mm:ss",...o.value,modelValue:n.modelValue,"onUpdate:modelValue":l},t)],["select",i],["selects",i],["array",()=>()=>k(Tn,{modelValue:n.modelValue,"onUpdate:modelValue":l,...o.value},t)],["remoteSelect",m],["remoteSelects",m],["city",()=>{let y=o.value.level?o.value.level-1:2;const d=ke({value:"ready",nodes:[],key:"",currentRequest:null});let s={};const E=(R,x)=>s[R]&&s[R][x]?s[R][x]:!1,F=(R,x,L=[])=>{s[R]||(s[R]={}),s[R][x]=L};return()=>k(D("el-cascader"),{modelValue:n.modelValue,"onUpdate:modelValue":l,class:"w100",clearable:!0,valueOnClear:"",props:{lazy:!0,lazyLoad(R,x){const{level:L,pathValues:I}=R;let w=I.join(",");w=w||"init";let f=E(L,w);if(f)return x(f);if(d.key==w&&d.value==n.modelValue)return d.currentRequest?d.currentRequest:x(d.nodes);let b=[];d.key=w,d.value=n.modelValue,d.currentRequest=Go(I).then(C=>{let v=!1;n.modelValue&&typeof n.modelValue[0]=="string"&&(v=!0);for(const O in C.data)v&&(C.data[O].value=C.data[O].value.toString()),C.data[O].leaf=L>=y,b.push(C.data[O]);d.nodes=b,d.currentRequest=null,F(L,w,b),x(b)})}},...o.value},t)}],["image",u],["images",u],["file",u],["files",u],["icon",()=>()=>k(_n,{modelValue:n.modelValue,"onUpdate:modelValue":l,...o.value},t)],["color",()=>()=>k(D("el-color-picker"),{modelValue:n.modelValue,"onUpdate:modelValue":y=>{e("update:modelValue",y===null?"":y)},...o.value},t)],["editor",()=>()=>k(wa,{class:"w100",modelValue:n.modelValue,"onUpdate:modelValue":l,...o.value},t)],["default",()=>{console.warn("暂不支持"+n.type+"的输入框类型，你可以自行在 BaInput 组件内添加逻辑")}]]);return(g.get(n.type)||g.get("default")).call(this)}}),Da=re(Ea,[["__scopeId","data-v-9a1fd2a0"]]);export{Da as B,_n as I,N as S,Nl as T,dl as a,aa as b,Na as d,Ra as f,wn as i,q as n};
