import{e as K,p as S,al as L,a as F,B as I,m as u,W as g,o as m,N as h,O as p,Z as x,h as d,U as k,V as P,v as e,k as U,j as N,l as r,$ as R,a7 as M,aa as X,Y as y,_ as f,X as Y}from"./vue-DkQzphiS.js";import{e as Z,x as G,_ as H}from"./index-B0iOz79E.js";import{F as i}from"./index-tQazVPhs.js";import{b as c}from"./validate-DcgMk89l.js";import{a as Q}from"./pay-CU2cU_nZ.js";import"./index-CJwZD0Ka.js";import"./index-DJv0ClnV.js";const ee={class:"title"},le=K({__name:"popupForm",setup(te){const C=Z(),V=S(),t=L("baTable"),{t:l}=G.useI18n(),_=S({}),s=F({});I(s,n=>{t.form.items.config=JSON.stringify(n)},{deep:!0}),I(()=>{var n;return(n=t.form.items)==null?void 0:n.config},n=>{if(n)try{Object.assign(s,JSON.parse(n))}catch(a){console.error("解析配置失败:",a)}},{immediate:!0});const j=async n=>{if(n)try{const a=await Q(n);_.value=a.data.info||{},Object.keys(s).forEach(v=>delete s[v])}catch(a){console.error("获取插件配置失败:",a)}},B=n=>{switch(n){case"textarea":return"textarea";case"select":return"select";default:return"string"}},E=n=>{const a={};return n.type==="textarea"?a.rows=3:n.type==="select"&&n.options&&(a.content=n.options),a},O=F({name:[c({name:"required",title:l("channel.name")})],plugin_id:[c({name:"required",title:l("channel.plugin_id")})],min_amount:[c({name:"number",title:l("channel.min_amount")})],max_amount:[c({name:"number",title:l("channel.max_amount")})],priority:[c({name:"number",title:l("channel.priority")})]});return(n,a)=>{const v=u("el-alert"),z=u("el-form"),D=u("el-scrollbar"),w=u("el-button"),T=u("el-dialog"),W=g("drag"),$=g("zoom"),A=g("loading"),q=g("blur");return m(),h(T,{class:"ba-operate-dialog","close-on-click-modal":!1,"model-value":["Add","Edit","Config"].includes(e(t).form.operate),onClose:e(t).toggleForm,width:"50%"},{header:p(()=>[x((m(),d("div",ee,[k(P(e(t).form.operate==="Config"?"配置支付参数":e(t).form.operate?e(l)(e(t).form.operate):""),1)])),[[W,[".ba-operate-dialog",".el-dialog__header"]],[$,".ba-operate-dialog"]])]),footer:p(()=>[U("div",{style:N("width: calc(100% - "+e(t).form.labelWidth/1.8+"px)")},[r(w,{onClick:a[16]||(a[16]=o=>e(t).toggleForm())},{default:p(()=>[k(P(e(l)("Cancel")),1)]),_:1}),x((m(),h(w,{loading:e(t).form.submitLoading,onClick:a[17]||(a[17]=o=>e(t).onSubmit(V.value)),type:"primary"},{default:p(()=>[k(P(e(t).form.operateIds&&e(t).form.operateIds.length>1?e(l)("Save and edit next item"):e(l)("Save")),1)]),_:1},8,["loading"])),[[q]])],4)]),default:p(()=>[x((m(),h(D,{class:"ba-table-form-scrollbar"},{default:p(()=>[U("div",{class:R(["ba-operate-form","ba-"+e(t).form.operate+"-form"]),style:N(e(C).layout.shrink?"":"width: calc(100% - "+e(t).form.labelWidth/2+"px)")},[e(t).form.loading?f("",!0):(m(),h(z,{key:0,ref_key:"formRef",ref:V,onSubmit:a[14]||(a[14]=M(()=>{},["prevent"])),onKeyup:a[15]||(a[15]=X(o=>e(t).onSubmit(V.value),["enter"])),model:e(t).form.items,"label-position":e(C).layout.shrink?"top":"right","label-width":e(t).form.labelWidth+"px",rules:O},{default:p(()=>[e(t).form.operate==="Add"?(m(),d(y,{key:0},[r(v,{type:"info",closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}},{default:p(()=>a[18]||(a[18]=[U("p",null,"请先添加基本参数，保存后在右侧操作栏配置支付参数",-1)])),_:1}),r(i,{label:e(l)("channel.name"),type:"string",modelValue:e(t).form.items.name,"onUpdate:modelValue":a[0]||(a[0]=o=>e(t).form.items.name=o),prop:"name",placeholder:e(l)("Please input field",{field:e(l)("channel.name")})},null,8,["label","modelValue","placeholder"]),r(i,{label:e(l)("channel.plugin_id"),type:"remoteSelect",modelValue:e(t).form.items.plugin_id,"onUpdate:modelValue":a[1]||(a[1]=o=>e(t).form.items.plugin_id=o),prop:"plugin_id","input-attr":{pk:"plugins.id",field:"plugin_name",remoteUrl:"/admin/Plugins/index"},placeholder:e(l)("Please select field",{field:e(l)("channel.plugin_id")})},null,8,["label","modelValue","placeholder"]),r(i,{label:e(l)("channel.min_amount"),type:"number",modelValue:e(t).form.items.min_amount,"onUpdate:modelValue":a[2]||(a[2]=o=>e(t).form.items.min_amount=o),prop:"min_amount","input-attr":{step:.01,precision:2},placeholder:e(l)("Please input field",{field:e(l)("channel.min_amount")})},null,8,["label","modelValue","placeholder"]),r(i,{label:e(l)("channel.max_amount"),type:"number",modelValue:e(t).form.items.max_amount,"onUpdate:modelValue":a[3]||(a[3]=o=>e(t).form.items.max_amount=o),prop:"max_amount","input-attr":{step:.01,precision:2},placeholder:e(l)("Please input field",{field:e(l)("channel.max_amount")})},null,8,["label","modelValue","placeholder"]),r(i,{label:e(l)("channel.priority"),type:"number",modelValue:e(t).form.items.priority,"onUpdate:modelValue":a[4]||(a[4]=o=>e(t).form.items.priority=o),prop:"priority","input-attr":{step:1},placeholder:e(l)("Please input field",{field:e(l)("channel.priority")})},null,8,["label","modelValue","placeholder"]),r(i,{label:e(l)("channel.status"),type:"radio",modelValue:e(t).form.items.status,"onUpdate:modelValue":a[5]||(a[5]=o=>e(t).form.items.status=o),prop:"status","input-attr":{content:{0:e(l)("channel.status 0"),1:e(l)("channel.status 1")}},placeholder:e(l)("Please select field",{field:e(l)("channel.status")})},null,8,["label","modelValue","input-attr","placeholder"]),r(i,{label:e(l)("channel.remark"),type:"string",modelValue:e(t).form.items.remark,"onUpdate:modelValue":a[6]||(a[6]=o=>e(t).form.items.remark=o),prop:"remark",placeholder:e(l)("Please input field",{field:e(l)("channel.remark")})},null,8,["label","modelValue","placeholder"])],64)):f("",!0),e(t).form.operate==="Config"?(m(),d(y,{key:1},[_.value.inputs?(m(!0),d(y,{key:0},Y(_.value.inputs,(o,b)=>(m(),d("div",{key:b},[r(i,{label:o.name,type:B(o.type),modelValue:s[b],"onUpdate:modelValue":J=>s[b]=J,prop:"config."+b,"input-attr":E(o),placeholder:o.note||e(l)("Please input field",{field:o.name})},null,8,["label","type","modelValue","onUpdate:modelValue","prop","input-attr","placeholder"])]))),128)):f("",!0)],64)):f("",!0),e(t).form.operate==="Edit"?(m(),d(y,{key:2},[r(i,{label:e(l)("channel.name"),type:"string",modelValue:e(t).form.items.name,"onUpdate:modelValue":a[7]||(a[7]=o=>e(t).form.items.name=o),prop:"name",placeholder:e(l)("Please input field",{field:e(l)("channel.name")})},null,8,["label","modelValue","placeholder"]),r(i,{label:e(l)("channel.plugin_id"),type:"remoteSelect",modelValue:e(t).form.items.plugin_id,"onUpdate:modelValue":a[8]||(a[8]=o=>e(t).form.items.plugin_id=o),prop:"plugin_id","input-attr":{pk:"plugins.id",field:"plugin_name",remoteUrl:"/admin/Plugins/index",onChange:j},placeholder:e(l)("Please select field",{field:e(l)("channel.plugin_id")})},null,8,["label","modelValue","input-attr","placeholder"]),r(i,{label:e(l)("channel.min_amount"),type:"number",modelValue:e(t).form.items.min_amount,"onUpdate:modelValue":a[9]||(a[9]=o=>e(t).form.items.min_amount=o),prop:"min_amount","input-attr":{step:.01,precision:2},placeholder:e(l)("Please input field",{field:e(l)("channel.min_amount")})},null,8,["label","modelValue","placeholder"]),r(i,{label:e(l)("channel.max_amount"),type:"number",modelValue:e(t).form.items.max_amount,"onUpdate:modelValue":a[10]||(a[10]=o=>e(t).form.items.max_amount=o),prop:"max_amount","input-attr":{step:.01,precision:2},placeholder:e(l)("Please input field",{field:e(l)("channel.max_amount")})},null,8,["label","modelValue","placeholder"]),r(i,{label:e(l)("channel.priority"),type:"number",modelValue:e(t).form.items.priority,"onUpdate:modelValue":a[11]||(a[11]=o=>e(t).form.items.priority=o),prop:"priority","input-attr":{step:1},placeholder:e(l)("Please input field",{field:e(l)("channel.priority")})},null,8,["label","modelValue","placeholder"]),r(i,{label:e(l)("channel.status"),type:"radio",modelValue:e(t).form.items.status,"onUpdate:modelValue":a[12]||(a[12]=o=>e(t).form.items.status=o),prop:"status","input-attr":{content:{0:e(l)("channel.status 0"),1:e(l)("channel.status 1")}},placeholder:e(l)("Please select field",{field:e(l)("channel.status")})},null,8,["label","modelValue","input-attr","placeholder"]),r(i,{label:e(l)("channel.remark"),type:"string",modelValue:e(t).form.items.remark,"onUpdate:modelValue":a[13]||(a[13]=o=>e(t).form.items.remark=o),prop:"remark",placeholder:e(l)("Please input field",{field:e(l)("channel.remark")})},null,8,["label","modelValue","placeholder"])],64)):f("",!0)]),_:1},8,["model","label-position","label-width","rules"]))],6)]),_:1})),[[A,e(t).form.loading]])]),_:1},8,["model-value","onClose"])}}}),se=H(le,[["__scopeId","data-v-37d14359"]]);export{se as default};
